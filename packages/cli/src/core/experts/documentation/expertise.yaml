domain: documentation
last_updated: 2026-02-14
version: 1.4

# AgileFlow-specific documentation structure (learned from actual codebase)
files:
  root_docs:
    - path: README.md
      purpose: Main project documentation (537 lines)
      sections:
        - "Quick Start (installation, CLI commands)"
        - "Supported IDEs (Claude Code, Cursor, Windsurf)"
        - "Why AgileFlow (methodology)"
        - "Folder Structure (docs/ layout)"
        - "Commands (41 slash commands)"
        - "Subagents (26 specialized agents)"
        - "Skills (23 auto-activating)"
        - "Hooks System (event-driven automation)"
        - "Advanced Topics (workflow, collaboration)"
    - path: packages/cli/README.md
      purpose: npm package README (identical to root)
      note: "Synced with root README"
    - path: SUBAGENTS.md
      purpose: Detailed subagent documentation

  docs_structure:
    - path: docs/00-meta/
      purpose: AgileFlow system metadata (guides, templates, scripts)
    - path: docs/01-brainstorming/
      purpose: Ideas and sketches
    - path: docs/02-practices/
      purpose: Codebase practices (styling, testing, git, CI)
      note: "USER's project practices, not AgileFlow's"
    - path: docs/03-decisions/
      purpose: Architecture Decision Records (ADRs)
      pattern: "adr-NNNN-title.md"
    - path: docs/04-architecture/
      purpose: System architecture documentation
    - path: docs/05-epics/
      purpose: Epic definitions
      pattern: "ep-NNNN-title.md"
    - path: docs/06-stories/
      purpose: User stories (grouped by epic)
      pattern: "US-NNNN.md"
    - path: docs/07-testing/
      purpose: Test cases and acceptance criteria
    - path: docs/08-project/
      purpose: Project management (roadmap, backlog, milestones)
    - path: docs/09-agents/
      purpose: Agent coordination
      key_files:
        - "status.json (story tracking)"
        - "bus/log.jsonl (agent messages)"
    - path: docs/10-research/
      purpose: Research notes and findings
      pattern: "YYYYMMDD-slug.md"

  templates:
    - path: docs/00-meta/templates/
      purpose: Document templates
      templates:
        - "epic-template.md"
        - "story-template.md"
        - "adr-template.md"
        - "agent-profile-template.md"
        - "research-template.md"

relationships:
  - name: readme_sync
    files: ["README.md", "packages/cli/README.md"]
    rule: "Should be identical or synced"

  - name: status_json
    file: "docs/09-agents/status.json"
    purpose: "Single source of truth for story statuses"
    consumers: ["babysit", "board", "status", "verify"]

  - name: agent_bus
    file: "docs/09-agents/bus/log.jsonl"
    purpose: "Agent coordination messages"
    format: "JSON Lines, append-only"

  - name: research_index
    file: "docs/10-research/README.md"
    purpose: "Index of research notes"
    updated_by: "research agent after saving notes"

patterns:
  - name: Docs-as-Code
    description: "Documentation versioned with code in git"

  - name: Numbered Directories
    description: "docs/ uses NN-name/ pattern (00-meta through 10-research)"

  - name: Status Tracking
    description: "status.json tracks all stories with owners, status, dependencies"

  - name: Collapsible Sections
    description: "README uses <details> tags for long sections"

  - name: Badge Headers
    description: "READMEs start with npm version, command count, agent count badges"

conventions:
  - "Use numbered directories in docs/ (00-meta through 10-research)"
  - "Status.json is single source of truth for story tracking"
  - "Research notes follow YYYYMMDD-slug.md pattern"
  - "ADRs follow adr-NNNN-title.md pattern"
  - "Use <details> tags for collapsible README sections"
  - "Include badges (npm version, counts) at top of README"
  - "Each folder should have README.md explaining its purpose"
  - "NO AI attribution in commits or documentation (see CLAUDE.md)"

# Learned from AgileFlow codebase exploration
learnings:
  - date: "2026-01-01"
    auto_generated: true
    context: "Test learning"
    insight: "This is a test"
  - date: 2025-12-21
    context: "Analyzed docs/ directory structure"
    insight: "10 numbered directories (00-meta through 10-research) organize all project documentation"
    source: "docs/"

  - date: 2025-12-21
    context: "Analyzed README structure"
    insight: "Main README is 537 lines with collapsible sections; uses badges for quick stats"
    source: "README.md"

  - date: 2025-12-21
    context: "Analyzed status tracking"
    insight: "status.json in docs/09-agents/ tracks all stories with owner, status, dependencies, test_status"
    source: "docs/09-agents/status.json"

  - date: 2025-12-21
    context: "Analyzed research pattern"
    insight: "Research notes use YYYYMMDD-slug.md pattern in docs/10-research/"
    source: "docs/10-research/"

  - date: 2025-12-24
    context: "Generated command documentation (batch 4 - operations)"
    insight: "Created 6 comprehensive operation command docs (ci, deploy, changelog, packages, tests, compress) following template with quick start, parameters, examples, workflow, output, and related commands sections"
    created_files:
      - "apps/docs/content/docs/commands/ci.mdx (155 lines)"
      - "apps/docs/content/docs/commands/deploy.mdx (324 lines)"
      - "apps/docs/content/docs/commands/changelog.mdx (329 lines)"
      - "apps/docs/content/docs/commands/packages.mdx (377 lines)"
      - "apps/docs/content/docs/commands/tests.mdx (449 lines)"
      - "apps/docs/content/docs/commands/compress.mdx (375 lines)"
    total_lines: 2009
    source: "packages/cli/src/core/commands/*.md"
    notes: "All files follow consistent documentation template: frontmatter, quick start, purpose, parameters table, examples with explanations, workflow steps, output/files, and related commands"

  - date: 2026-01-09
    context: "Created IDE Integrations documentation for AgileFlow"
    insight: "IDE handler system supports 4 IDEs (Claude Code, Cursor, Windsurf, OpenAI Codex) through plugin architecture. Each IDE has custom config directory (.claude/, .cursor/, .windsurf/, .codex/) and different installation models. Claude Code most advanced (damage control, spawnable agents), OpenAI Codex unique (per-repo skills, user-level prompts, AGENTS.md instructions)"
    created_files:
      - "apps/docs/content/docs/features/ide-integrations.mdx (700+ lines)"
      - "apps/docs/content/docs/features/index.mdx (updated with IDE section)"
    total_lines: 700
    source: "packages/cli/tools/cli/installers/ide/ (_base-ide.js, claude-code.js, cursor.js, windsurf.js, codex.js, manager.js)"
    coverage:
      - "IDE overview table with config dirs, types, status"
      - "Quick start for Claude Code (default IDE)"
      - "Multi-IDE installation instructions"
      - "Detailed setup for each IDE with directory structure"
      - "Command access patterns by IDE"
      - "Claude Code subagent spawning, damage control hooks"
      - "Cursor unique features, differences from Claude Code"
      - "Windsurf workflow management, VSCode integration"
      - "OpenAI Codex dual installation model (per-repo skills, user-level prompts, AGENTS.md)"
      - "Dynamic IDE handler system, extensibility guide"
      - "Content injection system explanation"
      - "Troubleshooting guide for common issues"
      - "Best practices for IDE selection and multi-IDE usage"
      - "Configuration management and version control"
    notes: "Comprehensive 700+ line documentation covering all 4 IDEs with detailed setup, command access, and unique features. Includes handler architecture for IDE developers extending with new IDEs."

  - date: 2026-02-03
    context: "Generated command documentation (batch 9 - missing commands)"
    insight: "Created 9 comprehensive command docs for audit, batch, choose, council, install, maintain, rlm, rpi, and workflow commands. All follow consistent template with quick start, parameters table, detailed explanations, usage examples, output formats, and related commands"
    created_files:
      - "apps/docs/content/docs/commands/audit.mdx (5.4K)"
      - "apps/docs/content/docs/commands/batch.mdx (6.2K)"
      - "apps/docs/content/docs/commands/choose.mdx (5.5K)"
      - "apps/docs/content/docs/commands/council.mdx (9.3K)"
      - "apps/docs/content/docs/commands/install.mdx (6.7K)"
      - "apps/docs/content/docs/commands/maintain.mdx (6.5K)"
      - "apps/docs/content/docs/commands/rlm.mdx (5.8K)"
      - "apps/docs/content/docs/commands/rpi.mdx (8.0K)"
      - "apps/docs/content/docs/commands/workflow.mdx (8.2K)"
    total_lines: 61_700_characters
    source: "packages/cli/src/core/commands/*.md (source command files)"
    coverage:
      - "audit: Story verification through GSD cycle (tests + acceptance criteria)"
      - "batch: Functional processing patterns (map/pmap/filter/reduce with loop mode)"
      - "choose: AI-directed decision making with structured options analysis"
      - "council: Multi-perspective strategic decisions (3 council members in parallel)"
      - "install: Post-installation validation with 6 check categories"
      - "maintain: Periodic health checks (updates, config, status.json, sessions)"
      - "rlm: Recursive document analysis without context rot (virtualized documents)"
      - "rpi: Research-Plan-Implement workflow with phase transitions"
      - "workflow: Parameterized workflow templates (built-in + custom)"
    notes: "All 9 files follow consistent documentation template extracted from source .md files: quick start, parameters table, detailed descriptions, usage examples with output, status indicators, best practices, error handling, and related commands. Ready for docs site publication."

  - date: 2026-02-07
    context: "Audited and fixed command documentation drift"
    insight: "Systematically compared all 50 source commands against their documentation counterparts. Found critical drift in configure.mdx (50% outdated) and babysit.mdx (missing Smart Detection, Story Claiming, Logic Audit features). Fixed both with comprehensive updates preserving all source details."
    modified_files:
      - "apps/docs/content/docs/commands/configure.mdx (major rewrite - 200+ lines added)"
      - "apps/docs/content/docs/commands/babysit.mdx (200+ lines added)"
    drift_issues_fixed:
      - "configure.mdx: Added 5 profile types (full, basic, minimal, experimental, none)"
      - "configure.mdx: Added hierarchical menu system documentation (5 categories, 4 max options)"
      - "configure.mdx: Added custom profiles (save, export, import, delete)"
      - "configure.mdx: Added all available features (8 total: SessionStart, PreCompact, RalphLoop, SelfImprove, Archival, StatusLine, AskUserQuestion, Tmux, Shell Aliases, Auto-Update, CLAUDE.md Rules)"
      - "configure.mdx: Added maintenance commands (detect, migrate, upgrade, repair, list-scripts)"
      - "configure.mdx: Added troubleshooting section with solutions"
      - "babysit.mdx: Added Smart Detection section (auto-enable Loop/Visual/Coverage/Conditions modes)"
      - "babysit.mdx: Added Story Claiming section (multi-session coordination, prevent conflicts)"
      - "babysit.mdx: Added Logic Audit integration (post-implementation quality check)"
      - "babysit.mdx: Updated Loop Mode to show auto-detection instead of explicit parameters"
    verified_good:
      - "council.mdx: Comprehensive and current"
      - "audit.mdx: Good alignment with source"
      - "choose.mdx: Good alignment with source"
    quality_gates:
      - "Description matches source frontmatter ✓"
      - "Parameters documented with types and defaults ✓"
      - "Examples are copy-paste ready ✓"
      - "Usage patterns match source implementation ✓"
      - "Links to related commands accurate ✓"
      - "No outdated information remains ✓"
      - "All new features from source documented ✓"
      - "Formatting consistent (tables, code blocks, bullets) ✓"
    source: "packages/cli/src/core/commands/*.md vs apps/docs/content/docs/commands/*.mdx"
    notes: "Used systematic comparison approach: extracted descriptions, parameters, and features from 50 source commands against documentation. Prioritized commands with most feature additions: babysit (Smart Detection, Story Claiming, Logic Audit), configure (profiles, hierarchical menus). All changes preserve source accuracy while making docs more discoverable and comprehensive."

  - date: 2026-02-14
    context: "Audited README files for v3.0.2 - IDE config locations and badge accuracy"
    insight: "Found and fixed 2 discrepancies between root and npm README files: (1) Cursor IDE config was .cursor/rules/ instead of .cursor/commands/ (verified against cursor.js installer), (2) OpenAI Codex location was incomplete - missing ~/.codex/prompts/ directory for user-level prompts. Both files now synchronized and identical."
    fixed_issues:
      - "packages/cli/README.md line 42: Updated Cursor from .cursor/rules/agileflow/ to .cursor/commands/agileflow/"
      - "packages/cli/README.md line 44: Updated Codex from .codex/skills/ to .codex/skills/ and ~/.codex/prompts/"
    verified:
      - "Badge counts: 93 commands (correct), 45 agents (correct), dynamic skills (correct)"
      - "All 11 referenced documentation files exist"
      - "All 6 example commands/agents exist in source"
      - "External links functional: npm (HTTP 200), GitHub (HTTP 200), docs site (HTTP 200)"
      - "README files now identical (diff shows no differences)"
    quality_gates:
      - "Documentation current with v3.0.2 code ✓"
      - "Counts verified against actual source files ✓"
      - "IDE config verified against installers ✓"
      - "All example commands/agents exist ✓"
      - "No deprecated information remains ✓"
      - "Two README files synchronized ✓"
    source: "README.md, packages/cli/README.md, packages/cli/tools/cli/installers/ide/*.js"
    notes: "Learned that IDE config locations can drift from documentation. Always verify against actual installer code (cursor.js, codex.js, etc.) not assumptions. OpenAI Codex has dual installation model (per-repo .codex/skills/ + user-level ~/.codex/prompts/) - this must be documented completely."
