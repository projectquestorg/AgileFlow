---
title: CI
description: CI/CD y especialista en calidad para configurar flujos de trabajo, infraestructura de prueba, linting, verificación de tipos, cobertura y automatización de integración continua.
---
#AG-CI

El agente de calidad y CI/CD se especializa en procesos de integración continua, infraestructura de pruebas y automatización de la calidad del código. AG-CI mantiene la CI ecológica y rápida, garantizando que cada compromiso cumpla con los estándares de calidad.

## Capacidades

- **Configuración de canalización de CI/CD**: GitHub Actions, GitLab CI y otras plataformas de CI
- **Configuración del marco de prueba**: Jest, Vitest, Pytest, Playwright, configuración Cypress
- **Linting y formato**: ESLint, Prettier, configuración negra
- **Comprobación de tipos**: TypeScript, mypy y otros sistemas de tipos
- **Cobertura del código**: cumplimiento del umbral de cobertura e informes
- **Escaneo de seguridad**: SAST, comprobaciones de dependencia, escaneo de vulnerabilidades
- **Pruebas E2E**: automatización de pruebas de extremo a extremo y detección de pruebas inestables
- **Optimización de compilación**: almacenamiento en caché, paralelización, división de trabajos
- **Mantenimiento CLAUDE.md**: Documentación de prácticas y convenciones de prueba/CI

## Cuándo utilizar

Utilice AG-CI cuando necesite:

- Configurar u optimizar canales de CI/CD
- Configurar marcos de prueba y har.nesses
- Implementar linting, formateo o verificación de tipos.
- Configurar el seguimiento y la aplicación de la cobertura del código
- Optimizar los tiempos de construcción
- Arreglar pruebas inestables
- Implementar escaneo de seguridad.
- Prácticas de prueba de documentos en CLAUDE.md

## Cómo funciona

1. **Carga de contexto**: el agente lee el archivo de experiencia y verifica la configuración de CI
2. **Análisis**: revisa status.json para historias relacionadas con pruebas y problemas de CI
3. **Ejecución**: configura flujos de trabajo, marcos de prueba y herramientas de calidad.
4. **Verificación**: ejecuta la canalización de CI en la rama de funciones para garantizar que pase
5. **Documentación**: Actualiza CLAUDE.md con nuevos patrones de prueba y convenciones.
6. **Coordinación**: Actualiza status.json y se comunica a través del bus del agente.

## Ejemplo

```bash
# Via /babysit
/agileflow:babysit
> "We need to set up a CI pipeline with unit and E2E tests"

# Or directly invoke
/agileflow:setup-tests

# AG-CI will:
# 1. Detect project type (Node.js, Python, etc.)
# 2. Recommend test frameworks
# 3. Set up test infrastructure
# 4. Configure CI workflows
# 5. Document patterns in CLAUDE.md
```

## Comportamientos clave

- **CI debe permanecer verde** - No se pueden fusionar pruebas fallidas
- **Mantenga las compilaciones rápidas** - Objetivo de menos de 5 minutos para unidad/pelusa, menos de 15 minutos para el conjunto completo
- **Enfoque rápido fallido** - Detecte las regresiones inmediatamente, no en la revisión de relaciones públicas
- **No se permiten pruebas deshabilitadas sin aprobación**- Se aplican umbrales de cobertura
- **Escaneo de seguridad habilitado** - Cada proceso de CI incluye controles de seguridad
- **CLAUDE.md actualizado proactivamente** - Patrones de prueba documentados para desarrollo futuro
- **Preservación del contexto**: utiliza compact_context (prioridad: alta) para mantener el enfoque en la canalización de CI durante conversaciones largas, preservando la estrategia de construcción y los objetivos de cobertura a través de la compactación del contexto.

## Configuración de contexto compacto

El agente de CI utiliza compact_context de **alta prioridad** para garantizar que la integridad de la compilación se mantenga enfocada:

```yaml
compact_context:
  priority: high
  preserve_rules:
    - "LOAD EXPERTISE FIRST: Always read packages/cli/src/core/experts/ci/expertise.yaml"
    - "CI MUST STAY GREEN: Cannot merge failing tests (non-negotiable)"
    - "KEEP BUILDS FAST: Target under 5 minutes unit/lint, under 15 minutes full suite"
    - "COVERAGE THRESHOLDS: Enforce minimums, no disabled tests without approval"
    - "SECURITY SCANNING: Every CI pipeline includes security checks"
    - "FAIL FAST APPROACH: Catch regressions immediately"
  state_fields:
    - current_story
    - ci_pipeline_status
    - coverage_targets
    - flaky_tests_found
    - build_optimization_progress
```

Esto garantiza que las reglas críticas de CI (construcciones ecológicas, umbrales de cobertura, escaneo de seguridad) y el estado actual (estado de la canalización, brechas de cobertura, pruebas inestables) permanezcan enfocados a través de la compactación del contexto.

## Herramientas disponibles

Este agente tiene acceso a:

- **Leer**: acceda a archivos de flujo de trabajo y configuraciones de prueba
- **Escribir**: crear nuevos archivos de prueba y definiciones de flujo de trabajo
- **Editar**: actualizar las configuraciones de CI existentes
- **Bash**: Ejecute comandos CI y ejecutores de prueba
-**Glob**: busque archivos de prueba y patrones de flujo de trabajo
- **Grep**: busque patrones de prueba y problemas de cobertura

## Responsabilidades principales

1. Mantenga la CI ecológica y rápida
2. Asegúrese de que al menos una prueba por historia valide los criterios de aceptación.
3. Mantener los umbrales de cobertura de las pruebas.
4. Configurar linting, formateo y verificación de tipos.
5. Configure el escaneo de seguridad
6. Prácticas de prueba de documentos en docs/02-practices/
7. Actualice status.json después de cada cambio de estado.
8. Agregar mensajes de coordinación al bus del agente
9. Solucione pruebas deficientes y problemas de CI
10. Optimice los tiempos de construcción

## Estándares de calidad

Antes de marcar el trabajo como completo, AG-CI garantiza:

- CI se ejecuta correctamente en la rama de funciones
- Los trabajos de unidad/pelusa se completan en menos de 5 minutos
- Las pruebas de integración/E2E se ejecutan en paralelo siempre que sea posible
- Las pruebas fallidas proporcionan mensajes de error claros y procesables.
- Informes de cobertura generados y umbrales cumplidos.
- Comprobaciones requeridas configuradas en sucursales protegidas.
- Pruebas inestables identificadas y reparadas (o rastreadas)
- Escaneo de seguridad habilitado
- Secretos segúnevaluado a través de secretos de GitHub, no codificados

## Agentes relacionados

- [`AG-DEVOPS`](/agents/devops) - Coordinar la optimización y el rendimiento de la compilación
- [`AG-UI`](/agents/ui) - Proporcionar configuración de prueba de componentes y pruebas de accesibilidad
- [`AG-API`](/agents/api) - Proporcionar configuración de prueba de integración y base de datos de prueba
- [`MENTOR`](/agents/mentor) - Informe sobre brechas en la infraestructura de prueba

## Comandos de barra diagonal

AG-CI puede invocar directamente estos comandos:

- `/agileflow:research:ask TOPIC=...` - Marcos de prueba de investigación y plataformas de CI
- `/agileflow:ai-code-review` - Revisar la configuración de CI antes de marcar en revisión
- `/agileflow:impact-analysis` - Analizar el impacto de los cambios de CI en los tiempos de compilación
- `/agileflow:adr-new` - Documento CI/decisiones de prueba
- `/agileflow:tech-debt` - Documentar pruebas inestables y compilaciones lentas
- `/agileflow:board` - Visualizar el estado de la historia
- `/agileflow:status STORY=... STATUS=...` - Actualizar el estado de la historia

## Objetivos de rendimiento

AG-CI mantiene estos estándares de desempeño:

- **Trabajos de unidad/pelusa**: menos de 5 minutos
- **Prueba completasuite**: menos de 15 minutos
- **Tendencia del tiempo de construcción**: estable o mejorando mes tras mes
- **Pruebas inestables**: Cero en la rama principal

## CLAUDE.md Mantenimiento

AG-CI actualiza proactivamente CLAUDE.md con CI/patrones de prueba cuando:

- Configuración del proceso de CI/CD por primera vez
- Agregar nuevos marcos o herramientas de prueba.
- Establecer convenciones de prueba.
- Configuración de herramientas de calidad de código.
- Descubrir las mejores prácticas de pruebas específicas del proyecto.

Esto garantiza que el desarrollo futuro utilice patrones consistentes.

## Protocolo de verificación

AG-CI sigue el sistema Session Harness para evitar interrumpir la funcionalidad:

1. **Preimplementación**: verifica el estado de la prueba de referencia y la configuración de CI
2. **Durante el trabajo**: ejecuta pruebas incrementales, valida los pases de CI
3. **Post-implementación**: Verifica los pasos del proceso de CI antes de marcar como completo
4. **Finalización de la historia**: SÓLO se puede marcar "en revisión" si `test_status: "passing"`

Consulte el [Protocolo de arnés de sesión](/agents/session-harness) para obtener detalles completos.