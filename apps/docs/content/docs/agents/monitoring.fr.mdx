---
title: Surveillance
description: Spécialiste de la surveillance pour l'observabilité, les stratégies de journalisation, les règles d'alerte, les tableaux de bord de métriques, les SLO et la visibilité de la production.
---
# AG-SUIVI

Le spécialiste en surveillance et observabilité conçoit et met en œuvre des solutions complètes d’observabilité. AG-MONITORING garantit que les systèmes de production sont visibles, sains et prêts à répondre aux incidents.

## Capacités

- **Journalisation structurée** : format JSON, ID de demande/trace, niveaux de journalisation appropriés
- **Collection de métriques** : métriques d'application, d'infrastructure et d'entreprise
- **Création de tableaux de bord** : tableaux de bord Grafana, Datadog, CloudWatch
- **Règles d'alerte** : alertes basées sur des seuils, basées sur des anomalies et composites
- **Définition SLO** : disponibilité, latence, taux d'erreur cibles avec budgets d'erreur
- **Traçage distribué** : demander le suivi des flux via le système
- **Contrôles de santé** : surveillance de l'état des points de terminaison et contrôles des dépendances
- **Runbooks de réponse aux incidents** : procédures de détection, de diagnostic et de résolution
- **Analyse des performances** : répartition de la latence et modèles d'utilisation des ressources

## Quand l'utiliser

Utilisez AG-MONITORING lorsque vous avez besoin de :

- Concevoir une architecture d'observabilité pour unservices
- Implémenter une journalisation structurée
- Mettre en place la collecte de métriques et les tableaux de bord
- Configurer les règles d'alerte et le routage des notifications
- Définir les SLO et les budgets d'erreurs
- Créer des runbooks de réponse aux incidents
- Surveiller la santé des applications en production
- Analyser les modèles de performances et de latence

## Comment ça marche

1. **Chargement du contexte** : l'agent lit le fichier d'expertise et examine la configuration de surveillance actuelle
2. **Conception** : planifie l'architecture d'observabilité (quoi enregistrer, quoi mesurer, quoi alerter)
3. **Mise en œuvre** : configure la journalisation, les métriques, les tableaux de bord et les alertes
4. **Vérification** : teste les contrôles de santé et les alertes lors de la préparation
5. **Documentation** : crée des runbooks d'incidents et une documentation SLO
6. **Coordination** : communique via le bus d'agent sur l'état de surveillance

## Exemple

```bash
# Via /babysit
/agileflow:babysit
> "Set up monitoring and alerting for the new API service"

# Or directly invoke
/agileflow:observability-setup

# AG-MONITORING will:
# 1. Design logging and metrics strategy
# 2. Set up structured JSON logging
# 3. Configure Prometheus/Grafana for metrics
# 4. Create dashboards
# 5. Configure alerting rules
# 6. Create incident runbooks
```

## Comportements clés

- **Journalisation structurée appliquée** - Aucun journal en texte brut non structuré en production
- **Alerte sur ce qui compte** - Réduisez le bruit avec des seuils intelligents
- **Préparez-vous aux échecs** - Créere runbooks avant que les incidents ne surviennent
- **Ne jamais enregistrer de PII** - Sécurité et conformité avant tout (pas de mots de passe, jetons, PII)
- **Surveiller le chemin heureux ET les erreurs** - Alerter sur les seuils de réussite et les échecs
- **Les SLO déterminent les décisions** - Les budgets d'erreur déterminent quand ralentir et régler la dette

## Piliers d'observabilité

AG-MONITORING met en œuvre les quatre piliers de l'observabilité :

### Métriques (quantitatives)
- Temps de réponse (latence)
- Débit (requêtes/seconde)
- Taux d'erreur (% d'échecs)
- Utilisation des ressources (CPU, mémoire, disque)
- Mesures commerciales (inscriptions, transactions)

### Journaux (événements détaillés)
- Journaux d'application (erreurs, avertissements, informations)
- Journaux d'accès (requêtes HTTP)
- Journaux d'audit (qui a fait quoi)
- Format structuré (JSON, facilement consultable)

### Traces (flux de demande)
- Traçage distribué via le système
- Répartition de la latence (où le temps est passé)
- Traces d'erreurs et traces de pile
- Dépendances des services

### Alertes (notification proactive)
- Basé sur un seuil (métrique > limite)
- Basé sur des anomalies (patt inhabituelerns)
- Composite (conditions multiples)
- Routage intelligent (qui avertir)

## Outils disponibles

Cet agent a accès à :

- **Lire** : accédez au code de l'application et aux modèles de journalisation
- **Écrire** : créer des utilitaires de journalisation et des configurations de surveillance
- **Modifier** : Mettre à jour les tableaux de bord et les règles d'alerte
- **Bash** : exécute les commandes de configuration de la surveillance
- **Glob** : recherchez des modèles de journalisation dans la base de code
- **Grep** : recherche de code lié à la surveillance

## Responsabilités principales

1. Concevoir une architecture d'observabilité
2. Mettre en œuvre une journalisation structurée
3. Configurer la collecte de métriques
4. Créez des règles d'alerte
5. Créez des tableaux de bord de surveillance
6. Définir les SLO et les budgets d'erreurs
7. Créer des runbooks de réponse aux incidents
8. Surveiller la santé des applications
9. Coordonner avec AG-DEVOPS sur la surveillance des infrastructures
10. Maintenir la documentation d'observabilité

## Normes de qualité

Avant la fin des travaux de marquage, AG-MONITORING assure :

- Journalisation structurée implémentée avec des ID de demande/trace
- Toutes les mesures critiques collectées et tableaux de bord
- Tableau de bordest créé et réellement utile
- Règles d'alerte configurées avec des seuils appropriés
- SLO définis avec des budgets d'erreur calculés
- Runbooks d'incidents créés pour les scénarios d'échec courants
- Le point de terminaison du contrôle de santé fonctionne et répond correctement
- Politique de conservation des journaux définie et appliquée
- Pas de PII/mots de passe/jetons dans les journaux
- Routage d'alerte testé et fonctionnel

## Niveaux de journalisation

AG-MONITORING utilise ces niveaux de journalisation :

- **ERREUR** : Service indisponible, perte de données, pannes critiques
- **WARN** : comportement dégradé, conditions inattendues, scénarios de nouvelle tentative
- **INFO** : changements d'état importants, déploiements, changements d'indicateurs de fonctionnalités
- **DEBUG** : informations de diagnostic détaillées (développement uniquement, pas production)

## Définition du SLO

Exemples de cibles SLO :

- **Disponibilité** : disponibilité de 99,9 % (temps d'arrêt de 8,7 heures/an)
- **Latence** : 95 % des requêtes inférieures à 200 ms
- **Taux d'erreur** : moins de 0,1 % de requêtes ayant échoué

Les budgets d'erreur déterminent la vitesse de déploiement : lorsque le budget est épuisé, concentrez-vous sur la stabilité.

## Agents associés

-[`AG-DEVOPS`](/agents/devops) - Coordonner la surveillance des infrastructures
- [`AG-API`](/agents/api) - Surveiller la latence des points de terminaison et les taux d'erreur
- [`AG-DATABASE`](/agents/database) - Surveiller la latence des requêtes et le pool de connexions
- [`AG-PERFORMANCE`](/agents/performance) - Collaborer sur le suivi des performances

## Commandes barre oblique

AG-MONITORING peut appeler directement ces commandes :

- `/agileflow:research:ask TOPIC=...` - Meilleures pratiques d'observabilité en recherche
- `/agileflow:ai-code-review` - Examiner le code de surveillance pour connaître les meilleures pratiques
- `/agileflow:adr-new` - Documenter les décisions de surveillance et d'observabilité
- `/agileflow:status STORY=... STATUS=...` - Mettre à jour l'état de l'histoire de surveillance

## Point de terminaison de vérification de l'état

AG-MONITORING implémente des contrôles de santé comme celui-ci :

```javascript
app.get('/health', async (req, res) => {
  const database = await checkDatabase();
  const cache = await checkCache();
  const external = await checkExternalService();

  const healthy = database && cache && external;
  const status = healthy ? 200 : 503;

  res.status(status).json({
    status: healthy ? 'healthy' : 'degraded',
    timestamp: new Date(),
    checks: { database, cache, external }
  });
});
```

Renvoie 200 si sain, 503 si une dépendance est en panne.

## Format du Runbook des incidents

AG-MONITORING crée des runbooks comme celui-ci :

```markdown
## [Incident Type]

**Detection**:
- Alert: [which alert fires]
- Symptoms: [what users see]

**Diagnosis**:
1. Check [metric 1]
2. Check [metric 2]
3. Verify [dependency]

**Resolution**:
1. [First step]
2. [Second step]
3. [Verification]

**Post-Incident**:
- Incident report
- Root cause analysis
- Preventive actions
```

## Protocole de vérification

AG-MONITORING suit le système Session Harness pour éviter toute rupture de fonctionnalité :

1. **Pré-implémentation** : vérifie l'état et l'environnement de surveillance de base
2. **Pendant le travail** : teste les contrôles de santé et les alertes en temps réel
3. **Post-mise en œuvre** : vérifie que la surveillance collecte des données avant de marquer comme terminée
4. **Achèvement de l'histoire** : peut UNIQUEMENT marquer "en cours de révision" si la surveillance est opérationnelle

Consultez le [Session Harness Protocol](/agents/session-harness) pour plus de détails.