---
title: Consulta de base de código
description: Pesquisa inteligente de base de código usando consultas programáticas em vez de RAG. Traduz linguagem natural em consultas estruturadas para exploração de código rápida e direcionada.
---
# Agente de consulta de base de código

O Codebase Query Agent é o seu especialista em exploração rápida e direcionada de base de código usando pesquisa programática (padrão RLM). Este agente traduz questões de linguagem natural em consultas estruturadas, permitindo a descoberta eficiente de código sem carregar arquivos inteiros no contexto.

## Capacidades

- **Tradução de linguagem natural**: converta perguntas como "onde a autenticação é tratada?" em consultas estruturadas
- **Pesquisa de padrão de arquivo**: Encontre arquivos por padrões globais e convenções de nomenclatura
- **Pesquisa de conteúdo**: pesquisas no estilo Grep por padrões de código, nomes de funções e texto
- **Pesquisa baseada em tags**: Encontre arquivos por tags semânticas (api, ui, auth, banco de dados, teste)
- **Descoberta de exportação**: localize onde os símbolos são exportados e usados
- **Mapeamento de dependências**: mostra quais arquivos importam/são importados por um determinado arquivo
- **Gerenciamento de orçamento de token**: respeite os limites do contexto truncando grandes resultados

## Quando usar

Use este agente quando precisar:

- Encontre arquivos relacionados a um recurso (autenticaçãoon, API, banco de dados, etc.)
- Localize definições de funções ou exportações
- Descubra dependências de arquivos e cadeias de importação
- Pesquise o conteúdo do código sem ler arquivos inteiros
- Explore rapidamente uma base de código desconhecida
- Construir contexto para implementar um recurso

## Como funciona

### Tradução de consulta

O agente traduz a linguagem natural em consultas estruturadas:

| O usuário diz | Tipo de consulta | Tradução |
|-----------|------------|------------|
| "Onde a autenticação é tratada?" | etiqueta + consulta | `--tag="auth"` + `--query="auth"` |
| "Quais arquivos usam a função de login?" | exportação | `--export="login"` |
| "Encontre arquivos com tratamento de erros" | conteúdo | `--content="try.*catch"` |
| "Mostre-me rotas de API" | etiqueta | `--tag="api"` |
| "Do que depende user.ts?" | dependências | `--deps="src/user.ts"` |
| "Arquivos de esquema de banco de dados" | etiqueta + consulta | `--tag="database"` + `--query="schema"` |
| "Componentes React usando ganchos" | conteúdo | `--content="use(State\|Effect\|Ref)"` |
| "Todos os arquivos de teste" | etiqueta | `--tag="test"` |

### Etiqueta disponívelé

| Etiqueta | Partidas |
|-----|---------|
| API | `/api/`, `/routes/`, `/controllers/` |
| interface do usuário | `/components/`, `/views/`, `/pages/` |
| autenticação | `/auth/`, `/login/`, `/jwt/` |
| banco de dados | `/db/`, `/models/`, `/migrations/` |
| teste | `/test/`, `/__tests__/`, `/spec/` |
| configuração | `/config/`, `/settings/` |
| biblioteca | `/lib/`, `/utils/`, `/helpers/` |

### Fluxo de trabalho

1. **Analisar consulta**: entenda o que o usuário está procurando
2. **Traduzir**: converta linguagem natural em tipos de consulta estruturada
3. **Verificar índice**: Certifique-se de que o índice da base de código esteja disponível (construa se necessário)
4. **Executar consulta**: execute a consulta com sinalizadores apropriados
5. **Formatar resultados**: retornar caminhos de arquivo com contexto
6. **Truncar se necessário**: Respeite os limites do orçamento de tokens

## Exemplo

```bash
# Via /babysit
/agileflow:babysit
> "Where is authentication handled in this codebase?"
```

O Agente de Consulta Codebase iria:
1. Traduzir para: __NOTRASLATE_44__ + `--query="auth"`
2. Verifique/construa índice
3. Pesquise arquivos que correspondam aos padrões de autenticação
4. Retorne resultados estruturados:
```
Query: "authentication files"
Translation: --tag="auth" + --query="auth"
Found: 8 files

Files:
- src/api/auth.ts (api, auth)
- src/middleware/auth.ts (auth)
- src/lib/jwt.ts (auth, lib)
- src/hooks/useAuth.ts (ui, auth)
...

[Context: Searched for files tagged 'auth' and matching 'auth' pattern]
```

## Principais comportamentos

- **SOMENTE LEITURA**: Este agente não pode gravar, editar ou modificar arquivos
- **Index-First**: sempre verifica/cria o índice da base de código antes de consultar
- **Token-Aware**: trunca os resultados para permanecer dentro do orçamento (padrão: 15.000 caracteres)
- **Saída Estruturada**: Retorna formato consistente com consulta, tradução e resultados
- **Estratégia de fallback**: usa Glob/Grep diretamente se o índice não estiver disponível

## Ferramentas disponíveis

Este agente tem acesso a:
- **Ler**: navegue pelos arquivos para entender o contexto
- **Glob**: descoberta de arquivos baseada em padrões
- **Grep**: pesquisa baseada em conteúdo

**Notavelmente ausente** (agente SOMENTE LEITURA):
- Sem ferramenta de gravação
- Sem ferramenta de edição
- Nenhuma ferramenta Bash (exceto para executar script de consulta)

## Tipos de consulta

### Consulta de padrão/palavra-chave
```bash
--query="auth"
```
Pesquisa inteligente combinando padrões globais, correspondência de tags e pesquisa de exportação.

### Pesquisa de conteúdo
__NOTRADUZIR_3__
Pesquisa de texto no estilo Grepdentro de arquivos.

### Pesquisa de tags
__NÃOTRADUZIR_4__
Encontre arquivos que correspondam aos padrões de tags semânticas.

### Exportar pesquisa
__NOTRADUZIR_5__
Encontre arquivos que exportam um símbolo específico.

### Pesquisa de dependência
__NOTRADUZIR_6__
Mostre o que o arquivo importa e o que o importa.

### Índice de construção
__NÃOTRADUZIR_7__
Reconstrua o índice da base de código (quando obsoleto ou ausente).

## Formato de saída

Formato de resposta padrão:

__NÃOTRADUZIR_8__

Para pesquisas de conteúdo, inclui linhas correspondentes:
__NOTRADUZIR_9__

## Gerenciamento de orçamento de token

O agente respeita os limites de token:
- Orçamento padrão: 15.000 caracteres
- Use __NOTRASLATE_46__ para resultados menores
- Grandes resultados são truncados com aviso prévio
- Mostra a contagem total mesmo quando truncada

## Comportamento substituto

Se o script ou índice de consulta não estiver disponível:

1. **Padrões de arquivo**: Use a ferramenta Glob para correspondência de padrões
2. **Pesquisa de conteúdo**: Use a ferramenta Grep para pesquisa de texto
3. **Combinar resultados**: desduplicar e formatar manualmente

## Integração com outros agentes

O Codebase Query Agent é típicolly invocado por:

- **MENTOR**: Encontre código relevante para implementação de recursos
- **AG-API**: localize implementações de API existentes
- **REFACTOR**: Encontre padrões de código para atualizar
- **AG-DEVOPS**: Encontre arquivos de configuração
- **EPIC-PLANNER**: Entenda a estrutura da base de código

Os resultados são retornados diretamente (sem necessidade de mensagens de barramento para consultas somente leitura).

## Padrão RLM

Este agente implementa o padrão Repository-Level Modeling (RLM):

- **Pesquisa programática**: consulte a base de código por meio de API estruturada, não RAG
- **Baseado em índice**: usa índice pré-construído para pesquisas rápidas
- **Token-Efficient**: Retorna apenas resultados relevantes, não arquivos inteiros
- **Determinístico**: a mesma consulta sempre retorna os mesmos resultados

Benefícios sobre RAG:
- Mais rápido (sem computação incorporada)
- Mais preciso (correspondências exatas)
- Menor custo (menor contexto)
- Determinístico (sem alucinações)

## Padrões Comuns

**Encontrar arquivos de implementação**
__NOTRADUZIR_10__

**Encontre sites de uso**
__NOTRADUZIR_11__

**Encontrar configuração**
```
"Where is [setting] configured?"
→ --tag="config" + --content="[setting]"
```

** Mãep Dependências**
__NÃOTRADUZIR_13__

## Agentes Relacionados

- [__NOTRASLATE_47____NOTRASLATE_51__ - Para pesquisas técnicas mais profundas além do código
- [`mentor`](/agents/mentor) - Freqüentemente invoca consulta de base de código para contexto
- [`refactor`](/agents/refactor) - Usa os resultados da consulta para planejar a refatoração
- [`devops`](/agents/devops) - Encontra configuração e código de infraestrutura

## Antipadrões

**NÃO:**
- Use ferramentas de gravação/edição (você é SOMENTE LEITURA)
- Carregue toda a base de código no contexto
- Ignorar o status do índice (verificar/construir primeiro)
- Retornar o conteúdo do arquivo bruto (retornar resultados estruturados)
- Exceder o orçamento do token (truncar com aviso prévio)

**FAZER:**
- Traduzir linguagem natural para tipos de consulta
- Verifique o status do índice antes de consultar
- Combine tipos de consulta para pesquisas complexas
- Mostrar contagem de correspondências e caminhos de arquivos
- Explique o que foi pesquisado e como