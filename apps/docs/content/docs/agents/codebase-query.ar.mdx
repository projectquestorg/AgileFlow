---
title: بحث قاعدة الرموز
description: بحث ذكي لقاعدة الرموز باستخدام الاستعلامات البرمجية بدلاً من RAG. يترجم اللغة الطبيعية إلى استعلامات منظمة للاستكشاف السريع والموجه للرموز.
---

# وكيل بحث قاعدة الرموز

وكيل بحث قاعدة الرموز هو متخصصك في استكشاف قاعدة الرموز السريع والموجه باستخدام البحث البرمجي (نمط RLM). يقوم هذا الوكيل بترجمة الأسئلة باللغة الطبيعية إلى استعلامات منظمة مما يمكن اكتشاف الرموز الفعال دون تحميل ملفات كاملة في السياق.

## القدرات

- **Natural Language Translation**: تحويل أسئلة مثل "أين يتم التعامل مع المصادقة؟" إلى استعلامات منظمة
- **File Pattern Search**: العثور على الملفات حسب أنماط glob والاتفاقيات الأسماء
- **Content Search**: البحث بنمط Grep عن أنماط الرموز وأسماء الدوال والنصوص
- **Tag-Based Search**: العثور على الملفات حسب العلامات الدلالية (api, ui, auth, database, test)
- **Export Discovery**: تحديد مكان تصدير الرموز واستخدامها
- **Dependency Mapping**: إظهار الملفات التي تستورد وتستورد بواسطة ملف معين
- **Token Budget Management**: احترام حدود السياق بتقطيع النتائج الكبيرة

## متى تستخدم

استخدم هذا الوكيل عندما تحتاج إلى:

- العثور على الملفات المتعلقة بميزة (المصادقة، API، قاعدة البيانات، إلخ)
- تحديد موقع تعريفات الدوال أو التصديرات
- اكتشاف تبعيات الملفات وسلاسل الاستيراد
- البحث عن محتوى الرموز دون قراءة ملفات كاملة
- استكشاف قاعدة رموز غير مألوفة بسرعة
- بناء السياق لتنفيذ ميزة

## كيف يعمل

### ترجمة الاستعلام

يترجم الوكيل اللغة الطبيعية إلى استعلامات منظمة:

| المستخدم يقول | نوع الاستعلام | الترجمة |
|-----------|------------|-------------|
| "أين يتم التعامل مع المصادقة؟" | tag + query | `--tag="auth"` + `--query="auth"` |
| "ما الملفات التي تستخدم دالة تسجيل الدخول؟" | export | `--export="login"` |
| "العثور على ملفات مع معالجة الأخطاء" | content | `--content="try.*catch"` |
| "أظهر لي مسارات API" | tag | `--tag="api"` |
| "ما الذي يعتمد عليه user.ts؟" | deps | `--deps="src/user.ts"` |
| "ملفات مخطط قاعدة البيانات" | tag + query | `--tag="database"` + `--query="schema"` |
| "مكونات React باستخدام hooks" | content | `--content="use(State\|Effect\|Ref)"` |
| "جميع ملفات الاختبار" | tag | `--tag="test"` |

### العلامات المتاحة

| العلامة | المطابقة |
|-----|---------|
| api | `/api/`, `/routes/`, `/controllers/` |
| ui | `/components/`, `/views/`, `/pages/` |
| auth | `/auth/`, `/login/`, `/jwt/` |
| database | `/db/`, `/models/`, `/migrations/` |
| test | `/test/`, `/__tests__/`, `/spec/` |
| config | `/config/`, `/settings/` |
| lib | `/lib/`, `/utils/`, `/helpers/` |

### سير العمل

1. **Parse Query**: فهم ما يبحث عنه المستخدم
2. **Translate**: تحويل اللغة الطبيعية إلى أنواع استعلام منظمة
3. **Check Index**: ضمان توفر فهرس قاعدة الرموز (الإنشاء إذا لزم الأمر)
4. **Execute Query**: تشغيل الاستعلام مع الأعلام المناسبة
5. **Format Results**: إرجاع مسارات الملفات مع السياق
6. **Truncate if Needed**: احترام حدود ميزانية الرموز

## مثال

```bash
# عبر /babysit
/agileflow:babysit
> "أين يتم التعامل مع المصادقة في هذه قاعدة الرموز؟"
```

سيقوم وكيل بحث قاعدة الرموز بـ:
1. ترجمة إلى: `--tag="auth"` + `--query="auth"`
2. التحقق/بناء الفهرس
3. البحث عن الملفات المطابقة لأنماط المصادقة
4. إرجاع النتائج المنظمة:
```
Query: "ملفات المصادقة"
Translation: --tag="auth" + --query="auth"
Found: 8 files

Files:
- src/api/auth.ts (api, auth)
- src/middleware/auth.ts (auth)
- src/lib/jwt.ts (auth, lib)
- src/hooks/useAuth.ts (ui, auth)
...

[Context: Searched for files tagged 'auth' and matching 'auth' pattern]
```

## السلوكيات الرئيسية

- **READ-ONLY**: لا يمكن لهذا الوكيل كتابة أو تحرير أو تعديل الملفات
- **Index-First**: التحقق دائمًا/بناء فهرس قاعدة الرموز قبل الاستعلام
- **Token-Aware**: تقطيع النتائج للبقاء ضمن الميزانية (الافتراضي: 15000 حرف)
- **Structured Output**: إرجاع تنسيق متسق مع الاستعلام والترجمة والنتائج
- **Fallback Strategy**: استخدام Glob/Grep مباشرة إذا كان الفهرس غير متاح

## الأدوات المتاحة

هذا الوكيل له الوصول إلى:
- **Read**: استعراض الملفات لفهم السياق
- **Glob**: اكتشاف الملفات القائم على النمط
- **Grep**: البحث القائم على المحتوى

**مفقود بشكل ملحوظ** (وكيل READ-ONLY):
- لا أداة Write
- لا أداة Edit
- لا أداة Bash (ما عدا تشغيل سكريبت الاستعلام)

## أنواع الاستعلام

### بحث النمط/الكلمة الرئيسية
```bash
--query="auth"
```
بحث ذكي يجمع بين أنماط glob ومطابقة العلامات والبحث عن التصديرات.

### بحث المحتوى
```bash
--content="validateToken"
```
بحث بنمط Grep عن النصوص في الملفات.

### بحث العلامة
```bash
--tag="api"
```
العثور على الملفات المطابقة لأنماط العلامات الدلالية.

### بحث التصدير
```bash
--export="login"
```
العثور على الملفات التي تصدر رمزًا محددًا.

### بحث التبعية
```bash
--deps="src/auth.js"
```
إظهار ما يستورده الملف وما يستورده.

### بناء الفهرس
```bash
--build-index
```
إعادة بناء فهرس قاعدة الرموز (عند كونه قديمًا أو مفقودًا).

## تنسيق الإخراج

تنسيق الاستجابة القياسي:

```
Query: "[original natural language query]"
Translation: [query flags used]
Index Status: [built/stale/missing]
Found: [N] files

Files:
- path/to/file.ts (tags)
- path/to/other.ts (tags)
...

[Context: explanation of what was searched]
```

للبحث عن المحتوى يتضمن الأسطر المطابقة:
```
Matches in path/to/file.ts:
  42: const token = validateToken(input);
  85: if (!validateToken(refreshToken)) {
```

## إدارة ميزانية الرموز

يحترم الوكيل حدود الرموز:
- ميزانية الافتراضية: 15000 حرف
- استخدم `--budget=5000` لنتائج أصغر
- النتائج الكبيرة يتم تقطيعها مع إشعار
- يظهر العدد الإجمالي حتى عند التقطيع

## السلوك البديل

إذا كان سكريبت الاستعلام أو الفهرس غير متاح:

1. **File Patterns**: استخدام أداة Glob لمطابقة النمط
2. **Content Search**: استخدام أداة Grep للبحث النصي
3. **Combine Results**: إزالة التكرار والتنسيق يدويًا

## التكامل مع وكلاء آخرين

عادةً ما يتم استدعاء وكيل بحث قاعدة الرموز من قبل:

- **MENTOR**: العثور على رموز ذات صلة لتنفيذ الميزة
- **AG-API**: تحديد موقع تنفيذ API الموجود
- **REFACTOR**: البحث عن أنماط الرموز للتحديث
- **AG-DEVOPS**: البحث عن ملفات التكوين
- **EPIC-PLANNER**: فهم بنية قاعدة الرموز

يتم إرجاع النتائج مباشرة (لا توجد حاجة لرسائل bus للاستعلامات القراءة فقط).

## نمط RLM

يطبق هذا الوكيل نمط Repository-Level Modeling (RLM):

- **Programmatic Search**: الاستعلام عن قاعدة الرموز عبر API منظمة وليس RAG
- **Index-Based**: استخدام فهرس مدمج مسبقًا للبحث السريع
- **Token-Efficient**: إرجاع النتائج ذات الصلة فقط وليس الملفات بالكامل
- **Deterministic**: نفس الاستعلام يرجع دائمًا نفس النتائج

الفوائد على RAG:
- أسرع (بدون حساب التضمين)
- أكثر دقة (مطابقات دقيقة)
- تكلفة أقل (سياق أصغر)
- حتمي (بدون هلوسة)

## الأنماط الشائعة

**البحث عن ملفات التنفيذ**
```
"أين يتم تنفيذ [ميزة]؟"
→ --tag="[relevant-tag]" + --query="[feature]"
```

**العثور على مواقع الاستخدام**
```
"ما الذي يستخدم [دالة/فئة]؟"
→ --export="[symbol]"
```

**البحث عن التكوين**
```
"أين يتم تكوين [إعداد]؟"
→ --tag="config" + --content="[setting]"
```

**خريطة التبعيات**
```
"ما الذي يعتمد عليه [ملف]؟"
→ --deps="[file-path]"
```

## الوكلاء ذات الصلة

- [`research`](/agents/research) - للبحث التقني الأعمق خارج الرموز
- [`mentor`](/agents/mentor) - غالبًا ما يستدعي codebase-query للسياق
- [`refactor`](/agents/refactor) - يستخدم نتائج الاستعلام لتخطيط الإعادة
- [`devops`](/agents/devops) - العثور على التكوين وملفات البنية الأساسية

## الأنماط المضادة

**لا تفعل:**
- استخدم أدوات Write/Edit (أنت READ-ONLY)
- تحميل قاعدة رموز كاملة في السياق
- تجاهل حالة الفهرس (التحقق/البناء أولاً)
- إرجاع محتويات الملفات الخام (إرجاع النتائج المنظمة)
- تجاوز ميزانية الرموز (التقطيع مع إشعار)

**افعل:**
- ترجم اللغة الطبيعية إلى أنواع الاستعلام
- تحقق من حالة الفهرس قبل الاستعلام
- اجمع أنواع الاستعلام للبحث المعقد
- أظهر عدد المطابقات ومسارات الملفات
- اشرح ما تم البحث عنه وكيفية البحث
