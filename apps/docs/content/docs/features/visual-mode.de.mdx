---
title: Visueller Modus
description: Screenshot-Verifizierungssystem für die UI-Entwicklung mit verifiziertem Präfix-Protokoll
---
# Visueller Modus

Visual Mode ist ein Screenshot-Verifizierungssystem für die UI-Entwicklung, das sicherstellt, dass alle visuellen Ausgaben überprüft und genehmigt werden, bevor eine Story als abgeschlossen markiert wird.

## Übersicht

Bei der Entwicklung von UI-Komponenten können visuelle Probleme wie die folgenden möglicherweise nicht durch Tests allein erkannt werden:
- Layoutprobleme
- Inkonsistenzen im Stil
- Responsive Design-Probleme
- Visuelle Regressionen

Der visuelle Modus behebt dieses Problem, indem er vor dem Fortfahren eine **Verifizierung** aller Screenshots (mit dem Präfix `verified-`) erfordert.

## Wie es funktioniert

### Das Verified-Prefix-Protokoll

1. Während der UI-Entwicklung werden Screenshots im Verzeichnis `screenshots/` gespeichert
2. Neue Screenshots werden ohne Präfix gespeichert (z. B. `login-form.png`)
3. Nach der visuellen Überprüfung werden genehmigte Screenshots mit dem Präfix `verified-` umbenannt
4. Der visuelle Modus prüft, ob ALLE Screenshots das Präfix `verified-` haben
5. Wenn unbestätigte Screenshots vorhanden sind, wird die Schleife zur Überprüfung angehalten

<Bild>
  <source media="(prefers-color-scheme: dark)" srcset="/images/docs/features/visual-mode-protocol.dark.svg" />
  <img alt="Verified Prefix Protocol" src="/images/docs/features/visual-mode-protocol.light.svg" />
</Bild>

## Schnellstart

Aktivieren Sie den visuellen Modus im Loop-Modus:

```bash
/agileflow:babysit EPIC=EP-0042 MODE=loop VISUAL=true
```

Oder führen Sie den Prüfer direkt aus:

```bash
node .agileflow/scripts/screenshot-verifier.js
```

## Screenshot-Workflow

### 1. Machen Sie während der Entwicklung Screenshots

Speichern Sie beim Implementieren von UI-Komponenten Screenshots:

```typescript
// In your test or component
await page.screenshot({ path: 'screenshots/user-profile.png' });
```

Oder manuell mit Browser-Entwicklungstools.

### 2. Überprüfen Sie die Screenshots

Der visuelle Modus wird angehalten, wenn nicht verifizierte Screenshots gefunden werden:

```
⚠️ Visual Mode: Unverified screenshots found

Unverified:
  - screenshots/user-profile.png
  - screenshots/settings-modal.png

Please review these screenshots and rename with 'verified-' prefix
when approved, or delete if issues found.
```

### 3. Überprüfen oder beheben

**Wenn der Screenshot korrekt aussieht:**
```bash
mv screenshots/user-profile.png screenshots/verified-user-profile.png
```

**Wenn Probleme gefunden werden:**
- Korrigieren Sie den UI-Code
- Machen Sie den Screenshot noch einmal
- Überprüfen Sie es noch einmal

### 4. Weiter

Sobald alle Screenshots überprüft wurden, wird die Schleife automatisch fortgesetzt.

## Verifier-Skript

### Nutzung

```bash
# Check all screenshots
node .agileflow/scripts/screenshot-verifier.js

# Check specific directory
node .agileflow/scripts/screenshot-verifier.js --dir=tests/screenshots

# Verbose output
node .agileflow/scripts/screenshot-verifier.js --verbose
```

### Exit-Codes

| Code | Bedeutung |
|------|---------|
| 0 | Alle Screenshots überprüft |
| 1 | Nicht verifizierte Screenshots gefunden |
| 2 | Fehler währendng-Überprüfung |

### Ausgabebeispiele

**Alle bestätigt:**
```
✅ Visual Mode: All screenshots verified

Verified: 5
  - verified-login-form.png
  - verified-user-profile.png
  - verified-settings-modal.png
  - verified-dashboard.png
  - verified-error-state.png
```

**Nicht bestätigt gefunden:**
```
❌ Visual Mode: 2 unverified screenshots

Verified: 3
Unverified: 2
  - new-feature.png
  - updated-header.png

Action required: Review and verify or delete unverified screenshots.
```

## Konfiguration

### Im Sitzungsstatus

Konfiguration des visuellen Modus in `session-state.json`:

```json
{
  "ralph_loop": {
    "enabled": true,
    "mode": "visual",
    "visual_config": {
      "screenshots_dir": "screenshots",
      "verified_prefix": "verified-",
      "extensions": [".png", ".jpg", ".jpeg", ".webp"]
    }
  }
}
```

### In Metadaten

Standardeinstellungen in `agileflow-metadata.json`:

```json
{
  "visual_mode": {
    "enabled": false,
    "screenshots_dir": "screenshots",
    "verified_prefix": "verified-",
    "auto_cleanup": true
  }
}
```

### Optionen

| Option | Standard | Beschreibung |
|--------|---------|-------------|
| `screenshots_dir` | `screenshots` | Verzeichnis zum Durchsuchen nach Screenshots |
| `verified_prefix` | `verified-` | Präfix für verifizierte Screenshots erforderlich |
| `extensions` | `[".png", ".jpg", ".jpeg", ".webp"]` | Zu überprüfende Bilddateierweiterungen |
| `auto_cleanup` | `true` | Verifizierte Screenshots nach epischem Abschluss entfernen |

## Integration mit Loop-Modus

Der visuelle Modus fungiert als zusätzlicher Überprüfungsschritt im [Schleifenmodus](/features/loop-mode):

<Bild>
  <source media="(prefers-color-scheme: dark)" srcset="/images/docs/features/visual-mode-loop.dark.svg" />
  <img alt="Visual Mode Loop Integration" src="/images/docs/features/visual-mode-loop.light.svg" />
</Bild>

## Wann Sie den visuellen Modus verwenden sollten

### Gut für

- ✅ Entwicklung von UI-Komponenten
- ✅ Systemimplementierungen entwerfen
- ✅ Responsive Layout-Arbeit
- ✅ Visuelle Regressionsprävention
- ✅ Sichtprüfung der Barrierefreiheit
- ✅ Theming- und Styling-Arbeit

### Nicht gut für

- ❌ Backend-/API-Entwicklung
- ❌ Datenbankmigrationen
- ❌ CI/CD-Konfiguration
- ❌ Nicht-visuelle Funktionen
- ❌ Nur automatisierte Test-Workflows

## Best Practices

### 1. Konsistente Screenshot-Benennung

Verwenden Sie beschreibende, konsistente Namen:

```
✅ Good:
  - login-form-default.png
  - login-form-error.png
  - login-form-loading.png

❌ Bad:
  - screenshot1.png
  - test.png
  - final-final-v2.png
```

### 2. Mehrere Staaten erfassen

Screenshot aller Komponentenzustände:

```typescript
// Default state
await page.screenshot({ path: 'screenshots/button-default.png' });

// Hover state
await button.hover();
await page.screenshot({ path: 'screenshots/button-hover.png' });

// Disabled state
await page.setContent('<button disabled>Click</button>');
await page.screenshot({ path: 'screenshots/button-disabled.png' });
```

### 3. Kontext einbeziehen

Machen Sie einen Screenshot mit genügend Kontext, um die Komponente zu verstehen:

```typescript
// Too narrow - just the button
await button.screenshot({ path: 'screenshots/button.png' });

// Better - button with surrounding context
await page.screenshot({
  path: 'screenshots/button-in-form.png',
  clip: { x: 0, y: 100, width: 400, height: 200 }
});
```

### 4. Aufräumen nach der Überprüfung

Entfernen Sie alte verifizierte Screenshots, wenn die Storys abgeschlossen sind:

```bash
# Manual cleanup
rm screenshots/verified-*.png

# Or enable auto_cleanup in config
```

### 5. Erwartetes Erscheinungsbild dokumentieren

Fügen Sie Notizen hinzu, was der Screenshot zeigen soll:

```markdown
## Screenshots

### verified-login-form.png
- Form with email and password fields
- Blue submit button
- "Forgot password?" link below
- No error states visible
```

## Fehlerbehebung

### SCreenshots nicht erkannt

1. Verzeichnispfad prüfen:
   ```bash
   ls screenshots/
   ```

2. Überprüfen Sie, ob die Dateierweiterungen korrekt sind:
   ```bash
   file screenshots/*.png
   ```

3. Überprüfen Sie den Konfigurationspfad in session-state.json

### Überprüfung wird nicht ausgeführt

1. Stellen Sie sicher, dass der visuelle Modus aktiviert ist:
   ```bash
   cat docs/09-agents/session-state.json | grep visual
   ```

2. Überprüfen Sie, ob der Loop-Modus aktiv ist:
   ```bash
   node .agileflow/scripts/ralph-loop.js --status
   ```

### Falsch Positive

Wenn Screenshots falsch gekennzeichnet werden:

1. Überprüfen Sie die Schreibweise des Präfixes: `verified-` (beachten Sie den Bindestrich)
2. Suchen Sie nach versteckten Zeichen im Dateinamen
3. Überprüfen Sie, ob es sich bei der Datei tatsächlich um ein Bild handelt

## Beispiel-Workflow

### UI-Story: Benutzer-Avatar-Komponente hinzufügen

**1. Die Geschichte beginnt, Claude implementiert die Komponente:**
```typescript
// src/components/Avatar.tsx
export function Avatar({ src, name, size = 'md' }) {
  return (
    <img
      src={src}
      alt={name}
      className={`avatar avatar-${size}`}
    />
  );
}
```

**2. Claude macht Screenshots:**
```bash
screenshots/
  avatar-small.png
  avatar-medium.png
  avatar-large.png
  avatar-fallback.png
```

**3. Visueller Modus pausiert:**
```
⚠️ Visual Mode: 4 unverified screenshots

Please review and verify:
  - avatar-small.png
  - avatar-medium.png
  - avatar-large.png
  - avatar-fallback.png
```

**4. Sie überprüfen und bestätigen:**
```bash
# All look good
for f in screenshots/avatar-*.png; do
  mv "$f" "screenshots/verified-$(basename $f)"
done
```

**5. Schleife geht weiter zur nächsten Geschichte**

## Verwandte Funktionen

- [Loop Mode](/features/loop-mode) – Autonome Story-Verarbeitung
- [Schadenskontrolle](/features/damage-control) - Schutz vor ZerstörungOperationen
- [`/agileflow:verify`](/commands/verify) – Manueller Verifizierungsbefehl

## Architektur

| Komponente | Zweck |
|-----------|---------|
| `screenshot-verifier.js` | Hauptverifizierungsskript |
| `ralph-loop.js` | Orchestriert Überprüfungen im visuellen Modus |
| `session-state.json` | Speichert die Konfiguration des visuellen Modus |
| `screenshots/` | Standard-Screenshot-Verzeichnis |

Der visuelle Modus lässt sich in den Stopphaken des Loop-Modus integrieren, um neben automatisierten Tests auch eine visuelle Überprüfung zu ermöglichen.