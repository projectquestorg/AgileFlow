---
title: Configuraci√≥n
description: Gu√≠a completa del sistema de configuraci√≥n de AgileFlow: 9 agentes para personalizar su flujo de trabajo de desarrollo
---
# Sistema de configuraci√≥n

El sistema de configuraci√≥n de AgileFlow proporciona 9 agentes especializados que configuran, personalizan y verifican cada aspecto de su flujo de trabajo de desarrollo. Accede a ellos a trav√©s de `/agileflow:configure`.

## Inicio r√°pido

```bash
# Interactive wizard - guides you through all options
/agileflow:configure

# Detect current configuration
/agileflow:configure --detect

# Enable specific features
/agileflow:configure --enable=damage-control,status-line,archival

# Upgrade to latest versions
/agileflow:configure --upgrade
```

## Los 9 agentes de configuraci√≥n

| Agente | Prop√≥sito | Caracter√≠stica clave |
|-------|---------|-------------|
| **git-config** | Inicializar git y repositorios remotos | Soporte SSH/HTTPS |
| **ganchos** | Automatizaci√≥n basada en eventos | Inicio de sesi√≥n, precompacto, parada |
| **precompacto** | Preservaci√≥n del contexto | Sobrevive a la compresi√≥n de la conversaci√≥n |
| **l√≠nea de estado** | Barra de estado personalizada | Historia, WIP, visualizaci√≥n de contexto |
| **archivo** | Administrar autom√°ticamente status.json | Limpieza basada en umbrales |
| **atribuci√≥n** | Pol√≠tica de confirmaci√≥n de Git | Controlar la divulgaci√≥n de IA |
| **ci** | Flujos de trabajo de CI/CD | Acciones de GitHub, GitLab, CircleCI |
| **control de da√±os** | Protecci√≥n de comando destructivo | Bloqueo basado en patrones |
| **verificar** | Configuraciones de prueba | Gesti√≥n de tokens |

## Orden de configuraci√≥n recomendado

```
Phase 1: Foundation (10-15 min)
‚îú‚îÄ 1. git-config      ‚Üí Enable version control
‚îú‚îÄ 2. hooks           ‚Üí Enable automation
‚îî‚îÄ 3. attribution     ‚Üí Establish commit policy

Phase 2: Safety (5-10 min)
‚îú‚îÄ 4. damage-control  ‚Üí Protect codebase
‚îî‚îÄ 5. verify          ‚Üí Validate setup

Phase 3: Productivity (15-20 min)
‚îú‚îÄ 6. archival        ‚Üí Manage status.json size
‚îú‚îÄ 7. status-line     ‚Üí Real-time visibility
‚îú‚îÄ 8. ci              ‚Üí Automated testing
‚îî‚îÄ 9. precompact      ‚Üí Long conversation support
```

---

## Detalles del agente

### 1. Configuraci√≥n de Git

**Prop√≥sito:** Inicializar el repositorio git y conectarse al control remoto (GitHub, GitLab, etc.)

**Qu√© hace:**
- Inicializa el repositorio de git si es necesario
- Configura URL remota (SSH o HTTPS)
- Verifica la conexi√≥n remota
- Almacena la configuraci√≥n en metadatos.

**Opciones:**
```
Initialize git:      Yes / No
Remote protocol:     SSH / HTTPS
Private repo:        Yes / No (for auth)
Verify connection:   Yes / No
```

**Archivos modificados:**
- `.git/` - Repositorio Git
- `docs/00-meta/agileflow-metadata.json` - Configuraci√≥n de Git almacenada
- `.claude/settings.local.json` - Fichas (si es necesario)

---

### 2. Sistema de ganchos

**Prop√≥sito:** Habilitar la automatizaci√≥n basada en eventos a trav√©s de los ganchos de Claude Code

**Ganchos disponibles:**
- **SessionStart** - Informaci√≥n de bienvenida cuando se inicia Claude Code
- **PreCompact** - Preservar el contexto antes de la compresi√≥n
- **Detener** - Resumen de la sesi√≥n cuando Claude se detiene
- **UserPromptSubmit** - Registro de actividad

**Opciones:**
```
SessionStart:        Enable / Disable
PreCompact:          Enable / Disable
Stop:                Enable / Disable
UserPromptSubmit:    Enable / Disable
```

**Archivos creados:**
- `.claude/settings.json` - Configuraci√≥n del gancho
- `scripts/agileflow-welcome.js` - Script de inicio de sesi√≥n
- `scripts/precompact-context.sh` - Script precompacto
- `scripts/agileflow-stop.sh` - Detener secuencia de comandos de enlace

**Importante:** Es necesario reiniciar Claude Code para que los enlaces surtan efecto.

---

### 3. Configuraci√≥n precompacta

**Prop√≥sito:** Preservar el contexto cr√≠tico del proyecto cuando Claude Code compacta las conversaciones

**Beneficios:**
- Las convenciones del proyecto sobreviven a la compresi√≥n.
- Se conservan las reglas de comando activas.
- Se mantiene la historia actual y el estado de WIP.
- Las convenciones del equipo no se pierden

**Resultado de ejemplo durante el proceso compacto:**
```
Project: MyProject v2.40.0 | Branch: main

Active Stories:
- US-0042 (in-progress): Login API
- US-0043 (blocked): Payment Integration

WIP Count: 2/3
Context Preservation: ENABLED
```

**Requiere:** Sistema de ganchos configurado primero

---

### 4. Configuraci√≥n de la l√≠nea de estado

**Prop√≥sito:** Configurar una barra de estado personalizada en Claude Code

**Componentes disponibles:**
- ID y t√≠tulo de la historia actual
- Progreso √©pico (historias X/Y)
- Recuento de WIP frente a l√≠mite de WIP
- Porcentaje de uso del contexto
- Costo de la sesi√≥n en USD
- Nombre de la rama de Git

**Ejemplo de l√≠neas de estado:**
```
[Opus] US-0042: Login API | WIP 2/3 | 45% ctx | main
agileflow v2.40.0 | US-0003 | main
```

**Opciones:**
```
Display components:  story, epic, wip, context, cost, git (multiselect)
Show git branch:     Yes / No
```

**Importante:** Requiere reiniciar Claude Code.

---

### 5. Configuraci√≥n de archivo

**Prop√≥sito:** Administrar autom√°ticamente el tama√±o del archivo status.json

**Por qu√© es importante:**
- status.json puede exceder el l√≠mite de tokens de 25k
- Cuando es demasiado grande, los agentes no pueden leerlo.
- El archivo autom√°tico evita esto en silencio

**Opciones de umbral:**
- **30 d√≠as** (recomendado) - Equilibrio entre contexto e historia
- **14 d√≠as** - Proyectos de r√°pido movimiento
- **7 d√≠as** - Equipos grandes con muchas historias
- **3 d√≠as** - Muy agresivo, status.json m√≠nimo

**Estructura de archivo:**
```
docs/09-agents/
‚îú‚îÄ‚îÄ status.json           # Active work
‚îú‚îÄ‚îÄ status-archive.json   # Historical
‚îî‚îÄ‚îÄ archive/
    ‚îú‚îÄ‚îÄ 2025-01.json      # Monthly archives
    ‚îî‚îÄ‚îÄ 2025-02.json
```

**Comandos manuales:**
```bash
# Archive with default threshold
bash scripts/archive-completed-stories.sh

# Archive with custom threshold (days)
bash scripts/archive-completed-stories.sh 7

# Compress status.json (removes verbose fields)
bash scripts/compress-status.sh
```

---

### 6. Configuraci√≥n de atribuci√≥n

**Prop√≥sito:** Configurar las preferencias de atribuci√≥n de confirmaci√≥n de git

**Opciones:**
- **Sin atribuci√≥n** (recomendado): confirmaciones limpias sin menciones de IA
- **Mantener atribuci√≥n** (predeterminado): incluye pie de p√°gina de Claude Code

**Ejemplo CLAUDE.md con atribuci√≥n deshabilitada:**
```markdown
## CRITICAL: NO AI Attribution in Git Commits

‚ùå FORBIDDEN:
- ü§ñ Generated with Claude Code
- Co-Authored-By: Claude

‚úÖ REQUIRED:
- Clean, professional commit messages
- Conventional commit format
```

---

### 7. Configuraci√≥n CI/CD

**Prop√≥sito:** Configurar flujos de trabajo de integraci√≥n continua

**Proveedores admitidos:**
- Acciones de GitHub (`.github/workflows/ci.yml`)
- GitLab CI (`.gitlab-ci.yml`)
- C√≠rculoCI (`.circleci/config.yml`)

**Comandos configurables:**
- Instalar dependientec√≠es
- Ejecutar pruebas
- Ejecutar linter
- Ejecutar verificador de tipo
- Construir proyecto

**Opciones:**
```
CI provider:         GitHub Actions / GitLab CI / CircleCI
Commands to run:     install, test, lint, type-check, build (multiselect)
Test locally:        Yes / No
Trigger remote CI:   Yes / No
```

---

### 8. Configuraci√≥n de control de da√±os

**Prop√≥sito:** Protege tu c√≥digo base de comandos destructivos

Consulte [Control de da√±os](/docs/features/damage-control) para obtener la documentaci√≥n completa.

**Niveles de protecci√≥n:**
- **Est√°ndar** - Coincidencia de patrones r√°pida, m√°s de 40 patrones
- **Mejorado** - Est√°ndar + evaluaci√≥n de IA
- **M√≠nimo** - S√≥lo protecci√≥n de ruta

**Opciones:**
```
Protection level:    Standard / Enhanced / Minimal
Custom protections:  Prod DB / Cloud CLI / Env files (multiselect)
```

---

### 9. Agente de verificaci√≥n

**Prop√≥sito:** Probar y validar que las configuraciones funcionen correctamente

**Qu√© valida:**
- Sintaxis de archivos JSON (configuraciones, metadatos)
- Ejecuci√≥n del script de gancho
- Sintaxis de flujo de trabajo YAML
- Comandos CI (pruebas locales)
- Conexiones remotas

**Gesti√≥n de tokens:**
- Almacena tokens en `.claude/settings.local.json` (gitignored)
- Admite tokens GitHub, GitLab, CircleCI
- Nunca hace eco de los tokens a la consola.

---

## Organizaci√≥n de archivos

```
project/
‚îú‚îÄ‚îÄ .github/workflows/ci.yml          # GitHub Actions
‚îú‚îÄ‚îÄ .claude/
‚îÇ   ‚îú‚îÄ‚îÄ settings.json                 # Hooks & status line (committed)
‚îÇ   ‚îú‚îÄ‚îÄ settings.local.json           # User overrides (gitignored)
‚îÇ   ‚îî‚îÄ‚îÄ settings.local.example.json   # Template for team
‚îú‚îÄ‚îÄ .agileflow/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ damage-control-patterns.yaml
‚îÇ   ‚îî‚îÄ‚îÄ scripts/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ agileflow-welcome.js
‚îÇ   ‚îú‚îÄ‚îÄ agileflow-statusline.sh
‚îÇ   ‚îî‚îÄ‚îÄ precompact-context.sh
‚îú‚îÄ‚îÄ CLAUDE.md                         # Project guidelines
‚îî‚îÄ‚îÄ docs/00-meta/
    ‚îî‚îÄ‚îÄ agileflow-metadata.json       # Configuration metadata
```

## Reglas de Gitignore

**Comprometido (configuraci√≥n del equipo):**
- `.claude/settings.json`
- __NOTRADUCIR_31__
- `.github/workflows/`
- `CLAUDE.md`
- `scripts/`
- `.agileflow/`

**Gitignored (espec√≠fico del usuario):**
- `.claude/settings.local.json`
- `.claude/prompt-log.txt`
- `.claude/*.log`

## Referencia de token

### Token de GitHub (ghp_xxx)
- **Ubicaci√≥n:** `.claude/settings.local.json`
- **√Åmbitos necesarios:** `repo`, `workflow`
- **Crear en:** https://github.com/settings/tokens/new

### Token de GitLab (glpat_xxx)
- **Ubicaci√≥n:** `.claude/settings.local.json`
- **√Åmbitos necesarios:** `api`, `read_repository`, `write_repository`
- **Crear en:** https://gitlab.com/-/profile/personal_access_tokens

### Ficha CircleCI
- **Ubicaci√≥n:** `.claude/settings.local.json`
- **Crear en:** https://app.circleci.com/settings/user/tokens

## Soluci√≥n de problemas

| Problema | Causa | Soluci√≥n |
|---------|-------|----------|
| La configuraci√≥n no tiene efecto | C√≥digo Claude no reiniciado | Salir (Cmd+Q) y reiniciar |
| La autenticaci√≥n del token falla | Token caducado/no v√°lido | Regenerar en proveedor |
| Error de sintaxis YAML | Archivo de flujo de trabajo no v√°lido |Validar con yamllint |
| status.json demasiado grande | Supera el l√≠mite de tokens | Habilitar archivo (3-7 d√≠as) |
| Los ganchos no funcionan | settings.json no v√°lido | Verifique JSON con `jq` |
| Falta la l√≠nea de estado | Script no ejecutable | `chmod +x scripts/*.sh` |

### Requisito de reinicio

Estos agentes requieren **reinicio de Claude Code**:
- ganchos
- precompacto
- l√≠nea de estado
- control de da√±os

```bash
# Complete quit (not just closing window)
Cmd+Q (Mac) or Ctrl+Q (Windows/Linux)
# Wait 5 seconds, then reopen
```

### Revertir

```bash
# Restore from git
git checkout .claude/settings.json

# Remove problematic hook
jq 'del(.hooks.HookName)' .claude/settings.json > tmp.json && mv tmp.json .claude/settings.json

# Disable all hooks
jq 'del(.hooks)' .claude/settings.json > tmp.json && mv tmp.json .claude/settings.json
```

## Escenarios comunes

### Configuraci√≥n del proyecto nuevo
```bash
/agileflow:configure  # Select: Git Repository
/agileflow:configure  # Select: Hooks System
/agileflow:configure  # Select: Damage Control
/agileflow:configure  # Select: Verification
```

### Agregar CI/CD
```bash
/agileflow:configure  # Select: CI/CD Workflow
# Choose provider, commands, test locally
git add .github/workflows/ci.yml
git commit -m "ci: add GitHub Actions workflow"
```

### Optimizar para proyectos grandes
```bash
/agileflow:configure  # Select: Archival (7-14 days)
/agileflow:configure  # Select: Status Line
/agileflow:configure  # Select: PreCompact
```