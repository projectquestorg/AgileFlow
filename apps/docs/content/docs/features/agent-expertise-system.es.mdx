---
title: "Sistema de experiencia del agente"
description: "Agentes de mejora personal que mantienen la experiencia en el dominio y aceleran la ejecución de tareas a través del conocimiento aprendido."
---
# Sistema de experiencia del agente

El Sistema de experiencia de agentes es un patrón en el que los agentes mantienen **archivos de experiencia** (modelos mentales) de su dominio y los actualizan automáticamente a medida que trabajan. Esto crea un sistema de aprendizaje de circuito cerrado que hace que los agentes sean más rápidos y precisos con el tiempo.

## Descripción general

### El problema resuelto

Sin archivos de experiencia, cada sesión requiere la misma exploración:
- El agente comienza de nuevo
- Debe buscar la base del código para comprender la estructura.
- Repite la exploración para cada tarea.
- Nunca mejora ni aprende.

Con archivos de experiencia, los agentes se vuelven más inteligentes:
- Cargar modelo mental al inicio de la sesión.
- Saltar la exploración, centrarse en la construcción.
- Aprende de cada tarea
- Mejorar automáticamente a través de la superación personal.

### Beneficios clave

| Aspecto | Sin experiencia | Con experiencia |
|--------|------------------|----------------|
| **Velocidad** | Lento (debe explorar) | Rápido (conocimientos precargados) |
| **Precisión** | Variable (depende de la exploración) | Consistente (conocimientos validados) |
| **Aprendizaje** |Ninguno - se olvida de todo | Automático: se acumula con el tiempo |
| **Reutilización del conocimiento** | Cero: empieza desde cero | Completo: aprovecha todos los aprendizajes |
| **Tamaño de contexto** | Grande (exploración + construcción) | Pequeño (experiencia + construcción) |

## Cómo funciona

El sistema de experiencia sigue un **flujo de trabajo de tres pasos**:

### Paso 1: Planificar (con experiencia)

```
Load expertise.yaml → Validate against code → Create detailed plan
```

El agente:
1. **Lee** el archivo de experiencia (modelo mental del dominio)
2. **Lo valida** con el código real (el código es la fuente de la verdad)
3. **Planifica** el trabajo en base a conocimientos validados

**Ejemplo:**
```yaml
# expertise.yaml excerpt
files:
  schemas:
    - path: src/db/schema.ts
      purpose: Database table definitions
      key_exports: [tables, relations]
```

El agente lee esto y sabe exactamente dónde están los archivos de esquema, omitiendo las búsquedas de directorio.

### Paso 2: construir (ejecutar plan)

```
Execute changes → Capture diff → Validate result
```

El agente:
1. **Ejecuta** el plan de implementación
2. **Captura** lo que cambió (git diff)
3. **Valida** el resultado funciona

Resultado de ejemplo:
```
Modified files:
- src/db/schema.ts
- src/db/migrations/20250109_add_users.ts
- src/db/queries/users.ts
```

### Paso 3: Automejora (actualizar experiencia)

```
Analyze changes → Update expertise.yaml → Add learnings
```

El agente:
1. **Analiza** el git diff
2. **Arribafechas** el archivo de experiencia con nuevos conocimientos
3. **Agrega** una entrada de aprendizajes

**Ejemplo de entrada de aprendizajes:**
```yaml
learnings:
  - date: 2025-01-09
    insight: "User schema uses UUID for id field, not auto-increment"
    files_affected:
      - src/db/schema.ts
      - src/db/queries/users.ts
    context: "US-0042: Add user authentication"
```

## Estructura del archivo de experiencia

Cada dominio de agente tiene un archivo `expertise.yaml` que documenta:

### 1. Metadatos
```yaml
domain: database           # Domain identifier
last_updated: 2025-01-09  # When updated (helps detect staleness)
version: 1.1              # Schema version (for future migrations)
```

### 2. Sección de Archivos
Archivos clave que el agente necesita conocer:

```yaml
files:
  schemas:
    - path: src/db/schema.ts
      purpose: Database table definitions (Drizzle)
      key_exports: [tables, relations]
      conventions: "Table names plural, columns snake_case"

    - path: src/db/migrations/
      purpose: Migration files
      pattern: "YYYYMMDD_description.ts"
```

**Por qué esto es importante:** El agente sabe dónde están las cosas sin necesidad de buscarlas.

### 3. Sección de Relaciones
Cómo se relacionan las entidades del dominio:

```yaml
relationships:
  - parent: users
    child: posts
    type: one-to-many
    key: "posts.user_id references users.id"

  - parent: posts
    child: comments
    type: one-to-many
    cascade: delete
```

**Por qué esto es importante:** El agente comprende el flujo de datos y las dependencias.

### 4. Sección de Patrones
Enfoques recurrentes a seguir:

```yaml
patterns:
  - name: "Soft deletes"
    description: "Use deleted_at timestamp instead of hard DELETE"
    location: Tables with user data
    example: "All timestamps use deleted_at, never remove rows"

  - name: "Timestamp columns"
    description: "All tables have created_at and updated_at"
    location: Every table
    convention: "Auto-managed by ORM or triggers"
```

**Por qué esto es importante:** El agente aplica patrones consistentes automáticamente.

### 5. Sección de Convenciones
Normas a seguir en el dominio:

```yaml
conventions:
  - "Tables: lowercase, plural (users, posts, categories)"
  - "Columns: lowercase, snake_case (first_name, created_at)"
  - "Foreign keys: <table_singular>_id (user_id, post_id)"
  - "Required columns: id, created_at, updated_at"
  - "All queries use parameterized statements"
  - "Migrations must be reversible (up and down)"
```

**Por qué esto es importante:** El agente mantiene la coherencia con el código existente.

### 6. Sección de Aprendizajes
Actualizado automáticamente mediante automejora:

```yaml
learnings:
  - date: 2025-01-08
    insight: "User model uses UUID primary key, not auto-increment"
    files_affected: [src/db/schema.ts, src/db/queries/users.ts]
    context: "US-0041: User authentication setup"

  - date: 2025-01-09
    insight: "Migrations use TypeORM decorators, not raw SQL"
    files_affected: [src/db/migrations/]
    context: "US-0042: Add user roles table"
```

**Por qué esto es importante:** El agente recuerda lo que aprendió y mejorar tiempo.

## Ejemplo completo de flujo de trabajo

Aquí hay un flujo de trabajo real de principio a fin:

### Solicitud inicial
> "Agregar una tabla de sesiones para rastrear las sesiones de inicio de sesión de los usuarios"

### Paso 1: Planificar

El agente lee expert.yaml y sabe:
- Los esquemas están en `src/db/schema.ts`
- Las migraciones entran en `src/db/migrations/`
- Patrón: eliminaciones temporales con `deleted_at`
- Convención: claves primarias UUID
- Relaciones: las sesiones tienen muchos registros de auditoría.

**Plan creado:**
```markdown
1. Add sessions table to src/db/schema.ts
   - Columns: id (UUID), user_id (FK), token, expires_at, created_at, updated_at, deleted_at
2. Create migration: src/db/migrations/20250109_add_sessions.ts
3. Create query functions: src/db/queries/sessions.ts
4. Add pattern to conventions: "Sessions use token field for validation"
```

### Paso 2: construir

El agente ejecuta:
1. Modifica `src/db/schema.ts` - agrega tabla de sesiones
2. Crea un archivo de migración
3. Crea utilidades de consulta.
4. Valida con TypeScript

Git diff muestra:
```
 src/db/schema.ts          | +12 lines
 src/db/migrations/...ts   | +35 lines
 src/db/queries/sessions.ts | +45 lines
```

### Paso 3: Superación personal

Experiencia en actualizaciones de agentes:

```yaml
# New entry added automatically
files:
  queries:
    - path: src/db/queries/sessions.ts
      purpose: Session query functions
      new: true
      created_date: 2025-01-09

patterns:
  - name: "Token-based sessions"
    description: "Use token field for session validation, not auto-increment ID"
    location: src/db/schema.ts (sessions table)
    example: "Sessions stored with UUID token, validated on login"

learnings:
  - date: 2025-01-09
    insight: "Session table implemented with UUID id, token field, and soft delete"
    files_affected:
      - src/db/schema.ts
      - src/db/migrations/20250109_add_sessions.ts
      - src/db/queries/sessions.ts
    context: "US-0045: Add session tracking"
```

**Resultado:** La próxima vez que el agente trabaje en sesiones, ya conoce la estructura y los patrones.

## Agentes expertos disponibles

AgileFlow incluye experiencia en estos dominios:

### Fase piloto (MVP)
- **Base de datos** - Esquema, migraciones, consultas
- **API** - Comandos CLI, rutapruebas, puntos finales
- **UI** - Componentes, estilo, diseños

### Lanzamiento de la fase 1
- **Pruebas** - Archivos de prueba, patrones y marcos
- **CI/CD** - Acciones de GitHub, Docker, implementación
- **DevOps** - Infraestructura, Kubernetes, monitorización
- **Seguridad** - Autenticación, tokens, permisos

### Lanzamiento de la fase 2
- **Documentación** - LÉAME, documentos API, guías
- **Refactorización** - Limpieza y optimización de código
- **Rendimiento** - Almacenamiento en caché, optimización, evaluaciones comparativas
- **Accesibilidad** - WCAG, todos los patrones

### Lanzamiento de la fase 3+
- **Móvil** - React Native, iOS, Android
- **Integraciones** - Webhooks, API, servicios de terceros
- **Análisis** - Seguimiento, métricas, paneles
- **Monitoreo** - Observabilidad, alertas

## Patrones de flujo de trabajo de tres pasos

### Para un desarrollo completo de funciones

Utilice el **flujo de trabajo completo** al implementar una función completa:

```bash
# 1. Read the workflow prompt
cat packages/cli/src/core/experts/database/workflow.md

# 2. Make your request
# "Add user authentication with sessions and password reset"

# Agent automatically:
# - Loads expertise.yaml
# - Plans the feature
# - Builds it
# - Self-improves
```

### Para preguntas rápidas

Utilice el **mensaje de preguntas** para obtener información:

```bash
# 1. Read the question prompt
cat packages/cli/src/core/experts/database/question.md

# 2. Ask your question
# "Where are the migration files stored?"

# Agent loads expertise and answers from domain knowledge
```

### Para actualizaciones manuales

Utilice el **mensaje de mejora personal** aDespués de realizar cambios:

```bash
# 1. Make your code changes manually

# 2. Read the self-improve prompt
cat packages/cli/src/core/experts/database/self-improve.md

# 3. Run self-improvement
# Agent analyzes your changes and updates expertise.yaml
```

## Validación de experiencia

Utilice el script de validación proporcionado para garantizar que los archivos de experiencia sean precisos:

```bash
# Validate all expertise files
./scripts/validate-expertise.sh

# Validate specific domain
./scripts/validate-expertise.sh database

# Expected output
PASS  database
PASS  api
PASS  ui
WARN  testing - stale (45 days since update)
```

### Comprobaciones de validación

El validador comprueba:
- **Esquema** - Campos obligatorios presentes (dominio, última actualización, versión)
- **Estancamiento** - Archivo que no tenga más de 30 días
- **Tamaño** - El archivo permanece enfocado (menos de 200 líneas)
- **Aprendizajes** - El agente ha mejorado al menos una vez

## Métricas de experiencia

Supervise el estado de su sistema de experiencia:

```bash
# Show metrics dashboard
./scripts/expertise-metrics.sh

# Output as JSON (for logging)
./scripts/expertise-metrics.sh --json

# Output as CSV (for analysis)
./scripts/expertise-metrics.sh --csv
```

### Métricas rastreadas

```
╔════════════════════════════════════════════════╗
║        Agent Expert Metrics Dashboard          ║
╚════════════════════════════════════════════════╝

Summary
─────────────────────────────────────────────────
Total Experts:              15
With Learnings:             12 (80%)
Total Learnings Recorded:   48
Avg File Size:              145 lines

Staleness Distribution
─────────────────────────────────────────────────
Updated in last 7 days:     8
8-30 days old:              4
31-90 days old:             2
90+ days old:               1

Self-Improve Health
─────────────────────────────────────────────────
Good adoption: 12/15 agents learning
Average learnings per expert: 3.2
```

### Métricas clave

- **Tasa de automejora** - % de agentes que han automejorado (objetivo: 100%)
- **Aprendizajes promedio** - Acumulación de aprendizaje por experto (objetivo: 5+)
- **Estancamiento** - Qué tan actualizados están los archivos de experiencia (objetivo: menos de 7 días)
- **Tamaño de archivo** - Mantenga la experiencia enfocada (menos de 200 líneas cada una)

## Superación personal automática

El sistema puede actualizar automáticamente los archivos de experiencia según el trabajo realizado:

### Cómo funciona

```bash
# Script runs as a session stop hook
node scripts/auto-self-improve.js

# Process:
# 1. Detect which agent was active
# 2. Analyze git diff for changes
# 3. Generate learning summary
# 4. Append to expertise.yaml
```

### Ejemplo de aprendizaje automático

Si el agente modificó estos archivos:
```
src/db/schema.ts        # +10 lines
src/db/migrations/...ts # +25 lines
src/db/queries/users.ts # +30 lines
```

El sistema agrega automáticamente:
```yaml
learnings:
  - date: 2025-01-09
    auto_generated: true
    insight: "Modified 3 database files: added user schema updates and queries"
    files_touched:
      - src/db/schema.ts
      - src/db/migrations/20250109_extend_users.ts
      - src/db/queries/users.ts
    context: "Session work - database domain"
```

## Creando un nuevo agente experto

### 1. Crear directorio

```bash
mkdir -p packages/cli/src/core/experts/your-domain/
```

### 2. Copiar plantillas

```bash
cp packages/cli/src/core/experts/templates/expertise-template.yaml \
   packages/cli/src/core/experts/your-domain/expertise.yaml

cp packages/cli/src/core/experts/templates/question-template.md \
   packages/cli/src/core/experts/your-domain/question.md

cp packages/cli/src/core/experts/templates/self-improve-template.md \
   packages/cli/src/core/experts/your-domain/self-improve.md

cp packages/cli/src/core/experts/templates/workflow-template.md \
   packages/cli/src/core/experts/your-domain/workflow.md
```

### 3. Personalizar experticia.yaml

```yaml
domain: your-domain
last_updated: 2025-01-09
version: 1.0

files:
  primary:
    - path: src/your-domain/
      purpose: Main domain code location

  secondary:
    - path: src/lib/your-domain/
      purpose: Shared utilities

relationships: []
patterns: []
conventions: []
learnings: []
```

### 4. Actualizar el archivo del agente

Modifique el archivo del agente principal para cargar experiencia:

```markdown
# At the top of your agent (FIRST ACTION)

## FIRST ACTION: Load Expertise

Read your expertise file at `packages/cli/src/core/experts/your-domain/expertise.yaml`.

This contains your mental model of the domain, including:
- Key file locations
- Relationships between entities
- Patterns to follow
- Conventions to maintain
```

Y al final, ejecuta la mejora personal:

```markdown
## FINAL ACTION: Self-Improve

Read `packages/cli/src/core/experts/your-domain/self-improve.md`

Then analyze what you changed and update your expertise file.
```

## Mejores prácticas

### HACER

✅ **Validar la experiencia frente al código**: el código es fuente de verdad, la experiencia es memoria de trabajo
✅ **Mantenga la experiencia enfocada** - Un dominio por archivo (menos de 200 líneas)
✅ **Fecha de todos los aprendizajes**: realiza un seguimiento de cuándo se descubrieron los conocimientos
✅ **Utilice rutas de archivos específicas** - No diga "en algún lugar de src/", utilice rutas exactas
✅ **Eliminar información obsoleta** - Eliminar entradas que ya no se aplican
✅ **Ejecutar la validación periódicamente** - `./scripts/validate-expertise.sh`

### NO LO HAGAS

❌ **Confíe ciegamente en la experiencia**: verifique siempre con el código real
❌ **Dominio mixtos**: mantenga la experiencia en bases de datos separada de la experiencia en API
❌ **Editar manualmente los aprendizajes**: deja que la mejora personal se encargue de ello
❌ **Mantener entradas obsoletas**: eliminar conocimientos que ya no sean precisos
❌ **Omitir validación**: la experiencia obsoleta perjudica más que ayuda
❌ **Crea archivos enormes**: divídelos en múltiples dominios enfocados

## Principios clave

### 1. El código es fuente de verdad

Los archivos de experiencia son modelos mentales, como cómo un ingeniero entiende un sistema. Son útiles pero no autoritarios.

**Valide siempre con el código real** antes de confiar en la experiencia.

```yaml
# ✅ Good - validated against code
# Confirmed: Database uses UUID primary keys in all tables
# Checked: src/db/schema.ts line 45

# ❌ Bad - speculative
# Probably uses UUIDs
# I think the database is PostgreSQL
```

### 2. La experiencia acelera, no reemplaza

La experiencia ayuda a los agentes a trabajar más rápido al eliminar la exploración, pero los agentes aún deben validar los hallazgos.

**Utiliza la experiencia para saltarte la búsqueda, no para saltarte el pensamiento.**

### 3. El aprendizaje es automático

No mantenga manualmente archivos de experiencia. Ejecute `self-improve.md` después de realizar cambios.

**El sistema aprende automáticamente si utiliza el flujo de trabajo.**

### 4. La experiencia está enfocada

cada unoh experto se centra en UN dominio. No cree un "Experto en todo el frontend": cree un "Experto en componentes de React" o un "Experto en validación de formularios".

**Dominios limitados → Mejor enfoque → Aprendizaje más rápido**

### 5. Problemas de señales de estancamiento

Si la experiencia no se ha actualizado en 30 días, tampoco:
- El dominio es estable (¡bien!)
- El agente no está siendo utilizado (eliminarlo)
- La experiencia es incorrecta (actualízala)

**Utilice el script de validación para monitorear el estado.**

## Diagrama de arquitectura

<imagen>
  <fuente media="(prefiere-color-esquema: oscuro)" srcset="/images/docs/features/agent-expertise-arch.dark.svg" />
  <img alt="Arquitectura de experiencia del agente" src="/images/docs/features/agent-expertise-arch.light.svg" />
</imagen>

> El flujo de trabajo de circuito cerrado: los expertos cargan conocimientos, los validan, construyen con ellos y aprenden automáticamente de lo que hacen.

## Comparación: con y sin experiencia

### Sin experiencia (agente tradicional)

```
Session 1:
├─ Search codebase structure (5 min)
├─ Understand naming conventions (3 min)
├─ Find database schema file (2 min)
└─ Build feature (10 min)
Total: 20 minutes

Session 2: (Same task in different domain)
├─ Search codebase structure (5 min) ← Repeat!
├─ Understand naming conventions (3 min) ← Repeat!
├─ Find database schema file (2 min) ← Repeat!
└─ Build feature (10 min)
Total: 20 minutes ← No improvement
```

### Con experiencia (agente de mejora personal)

```
Session 1:
├─ Load expertise.yaml (instant)
├─ Validate against code (1 min)
├─ Build feature (10 min)
├─ Self-improve (2 min)
└─ Save learnings
Total: 13 minutes

Session 2: (Same task in same domain)
├─ Load expertise.yaml (instant) ← Faster exploration
├─ Validate against code (instant) ← Already knows structure
├─ Build feature (9 min) ← Slightly faster, better patterns
├─ Self-improve (2 min)
└─ Save learnings
Total: 11 minutes ← Improvement!

Session 10: (Regular work in domain)
├─ Load expertise.yaml (instant)
├─ No validation needed (already verified)
├─ Build feature (8 min) ← Experts apply patterns automatically
├─ Self-improve (1 min) ← Minimal updates
└─ Save learnings
Total: 9 minutes ← Continuous improvement
```

## Solucionar problemastintineo

### El archivo de experiencia está obsoleto

**Problema:** Última actualización hace más de 45 días

**Solución:**
1. Lea el expediente de experiencia
2. Verifique el estado actual del código
3. Actualice cualquier entrada inexacta
4. Ejecute la validación: `./scripts/validate-expertise.sh domain`

### No se registraron aprendizajes

**Problema:** El agente nunca ha mejorado

**Causa:** No se siguieron los pasos del flujo de trabajo o no se ejecutó la mejora automática.

**Solución:**
1. Ejecute el trabajo utilizando el flujo de trabajo completo
2. Asegúrese de que se complete el paso de mejora personal
3. Consulte experticia.yaml para ver la entrada de nuevos aprendizajes.

### El archivo es demasiado grande (>200 líneas)

**Problema:** El archivo de experiencia creció demasiado

**Causa:** El dominio es demasiado amplio o se agregaron entradas redundantes

**Solución:**
1. Dividir en varios archivos enfocados
2. Eliminar entradas duplicadas/obsoletas
3. Conserve sólo la información esencial

### La experiencia no coincide con el código

**Problema:** La información del archivo de experiencia es incorrecta

**Causa:** El código cambió sin actualizar la experiencia, o la experiencia nunca fue precisa

**Solución:**
1. Ejecutar validación: `./scripts/validate-expertise.sh`
2. Corregir manualmente los errores inexactosintenta
3. Configure el proceso para detectar esto antes
4. Ejecute la mejora personal después de la próxima sesión de trabajo.

## Investigación y lecturas adicionales

Este sistema se basa en el **patrón Agente Expert** de:

- **Fuente:** Curso de codificación agente táctica de IndyDevDan
- **Lección:** 13 - Agentes expertos: finalmente, agentes que realmente aprenden
- **Concepto:** Agentes que mantienen bases de conocimiento externas para la ejecución acelerada de tareas.

El patrón reconoce que:
1. Los agentes que exploran todo en cada sesión son ineficientes
2. El conocimiento persistente (archivos de experiencia) acelera drásticamente el trabajo
3. Los sistemas que se mejoran a sí mismos aprenden y mejoran con el tiempo
4. Los dominios enfocados crean un aprendizaje sostenible

Consulte la documentación de investigación para conocer la teoría detallada y los patrones de implementación.

## Resumen

El Agent Expertise System permite a los agentes mejorar a través de:

1. **Archivos de experiencia** - Modelos mentales de cada dominio
2. **Flujo de trabajo de tres pasos**: Planificar → Construir → Automejorar
3. **Aprendizaje automático**: actualizaciones de experiencia a medida que trabajan los agentes
4. **Validación y Métricas**: herramientas para garantizar la calidad
5. **Dominios Enfocados** - Conocimiento especializado para cada área

Este sistema de aprendizaje de circuito cerrado hace que los agentes sean más rápidos, más precisos y cada vez más valiosos a medida que acumulan conocimiento del dominio con el tiempo.