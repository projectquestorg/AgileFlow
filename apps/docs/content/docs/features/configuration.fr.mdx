---
title: Configuration
description: Guide complet du syst√®me de configuration d'AgileFlow - 9 agents pour personnaliser votre workflow de d√©veloppement
---
# Syst√®me de configuration

Le syst√®me de configuration d'AgileFlow fournit 9 agents sp√©cialis√©s qui configurent, personnalisent et v√©rifient chaque aspect de votre flux de travail de d√©veloppement. Acc√©dez-y via `/agileflow:configure`.

## D√©marrage rapide

```bash
# Interactive wizard - guides you through all options
/agileflow:configure

# Detect current configuration
/agileflow:configure --detect

# Enable specific features
/agileflow:configure --enable=damage-control,status-line,archival

# Upgrade to latest versions
/agileflow:configure --upgrade
```

## Les 9 Agents de Configuration

| Agent | Objectif | Caract√©ristique cl√© |
|-------|---------|-------------|
| **git-config** | Initialiser git et les d√©p√¥ts distants | Prise en charge SSH/HTTPS |
| **crochets** | Automatisation √©v√©nementielle | D√©but de session, pr√©compact, arr√™t |
| **pr√©compact** | Pr√©servation du contexte | Survit √† la compression des conversations |
| **ligne d'√©tat** | Barre d'√©tat personnalis√©e | Story, WIP, affichage contextuel |
| **archives** | G√©rer automatiquement status.json | Nettoyage bas√© sur un seuil |
| **attribution** | Politique de validation Git | Contr√¥ler la divulgation de l'IA |
| **ci** | Flux de travail CI/CD | Actions GitHub, GitLab, CircleCI |
| **contr√¥le des d√©g√¢ts** | Protection des commandes destructrices | Blocage bas√© sur des mod√®les |
| **v√©rifier** | Configurations de tests | Gestion des jetons |

## Ordre de configuration recommand√©

```
Phase 1: Foundation (10-15 min)
‚îú‚îÄ 1. git-config      ‚Üí Enable version control
‚îú‚îÄ 2. hooks           ‚Üí Enable automation
‚îî‚îÄ 3. attribution     ‚Üí Establish commit policy

Phase 2: Safety (5-10 min)
‚îú‚îÄ 4. damage-control  ‚Üí Protect codebase
‚îî‚îÄ 5. verify          ‚Üí Validate setup

Phase 3: Productivity (15-20 min)
‚îú‚îÄ 6. archival        ‚Üí Manage status.json size
‚îú‚îÄ 7. status-line     ‚Üí Real-time visibility
‚îú‚îÄ 8. ci              ‚Üí Automated testing
‚îî‚îÄ 9. precompact      ‚Üí Long conversation support
```

---

## D√©tails de l'agent

### 1. Configuration Git

**Objectif¬†:** Initialiser le r√©f√©rentiel git et se connecter √† distance (GitHub, GitLab, etc.)

**Ce qu'il fait¬†:**
- Initialise le d√©p√¥t git si n√©cessaire
- Configure l'URL distante (SSH ou HTTPS)
- V√©rifie la connexion √† distance
- Stocke la configuration dans les m√©tadonn√©es

**Options¬†:**
```
Initialize git:      Yes / No
Remote protocol:     SSH / HTTPS
Private repo:        Yes / No (for auth)
Verify connection:   Yes / No
```

**Fichiers modifi√©s¬†:**
- `.git/` - D√©p√¥t Git
- `docs/00-meta/agileflow-metadata.json` - Configuration Git stock√©e
- `.claude/settings.local.json` - Jetons (si n√©cessaire)

---

### 2. Syst√®me de crochets

**Objectif¬†:** Activer l'automatisation bas√©e sur les √©v√©nements via les hooks de Claude Code

**Crochets disponibles¬†:**
- **SessionStart** - Informations de bienvenue au d√©marrage de Claude Code
- **PreCompact** - Pr√©server le contexte avant la compression
- **Stop** - R√©sum√© de la session lorsque Claude s'arr√™te
- **UserPromptSubmit** - Journalisation des activit√©s

**Options¬†:**
```
SessionStart:        Enable / Disable
PreCompact:          Enable / Disable
Stop:                Enable / Disable
UserPromptSubmit:    Enable / Disable
```

**Fichiers cr√©√©s¬†:**
- `.claude/settings.json` - Configuration du crochet
- `scripts/agileflow-welcome.js` - Script de d√©marrage de session
- `scripts/precompact-context.sh` - Script pr√©compact
- `scripts/agileflow-stop.sh` - Arr√™ter le script de hook

**Important¬†:** N√©cessite le red√©marrage de Claude Code pour que les hooks prennent effet.

---

### 3. Configuration pr√©compacte

**Objectif¬†:** Pr√©server le contexte critique du projet lorsque Claude¬†Code compacte les conversations

**Avantages¬†:**
- Les conventions du projet survivent √† la compression
- R√®gles de commande active pr√©serv√©es
- Histoire actuelle et statut WIP maintenus
- Les conventions d'√©quipe ne se perdent pas

**Exemple de sortie pendant le compact¬†:**
```
Project: MyProject v2.40.0 | Branch: main

Active Stories:
- US-0042 (in-progress): Login API
- US-0043 (blocked): Payment Integration

WIP Count: 2/3
Context Preservation: ENABLED
```

**N√©cessite¬†:** Syst√®me Hooks configur√© en premier

---

### 4. Configuration de la ligne d'√©tat

**Objectif¬†:** Configurer une barre d'√©tat personnalis√©e dans Claude Code

**Composants disponibles¬†:**
- ID et titre de l'histoire actuelle
- Progr√®s √©pique (histoires X/Y)
- Nombre d'en-cours par rapport √† la limite d'en-cours
- Pourcentage d'utilisation du contexte
- Co√ªt de la s√©ance en USD
- Nom de la branche Git

**Exemples de lignes d'√©tat¬†:**
```
[Opus] US-0042: Login API | WIP 2/3 | 45% ctx | main
agileflow v2.40.0 | US-0003 | main
```

**Options¬†:**
```
Display components:  story, epic, wip, context, cost, git (multiselect)
Show git branch:     Yes / No
```

**Important¬†:** N√©cessite le red√©marrage de Claude Code.

---

### 5. Configuration des archives

**Objectif¬†:** G√©rer automatiquement la taille du fichier status.json

**Pourquoi c'est important¬†:**
- status.json peut d√©passer la limite de 25 000 jetons
- Lorsqu'il est trop gros, les agents ne peuvent pas le lire
- L'archivage automatique emp√™che cela en silence

**Options de seuil¬†:**
- **30 jours** (recommand√©) - Equilibre entre contexte et historique
- **14 jours** - Projets √† √©volution rapide
- **7 jours** - De grandes √©quipes avec de nombreuses histoires
- **3 jours** - Statut.json tr√®s agressif et minimal

**Structure des archives¬†:**
```
docs/09-agents/
‚îú‚îÄ‚îÄ status.json           # Active work
‚îú‚îÄ‚îÄ status-archive.json   # Historical
‚îî‚îÄ‚îÄ archive/
    ‚îú‚îÄ‚îÄ 2025-01.json      # Monthly archives
    ‚îî‚îÄ‚îÄ 2025-02.json
```

**Commandes manuelles¬†:**
```bash
# Archive with default threshold
bash scripts/archive-completed-stories.sh

# Archive with custom threshold (days)
bash scripts/archive-completed-stories.sh 7

# Compress status.json (removes verbose fields)
bash scripts/compress-status.sh
```

---

### 6. Configuration des attributions

**Objectif¬†:** Configurer les pr√©f√©rences d'attribution de git commit

**Options¬†:**
- **Aucune attribution** (recommand√©)¬†: commits propres sans mentions d'IA
- **Conserver l'attribution** (par d√©faut)¬†: inclure le pied de page du code Claude

**Exemple CLAUDE.md avec attribution d√©sactiv√©e¬†:**
```markdown
## CRITICAL: NO AI Attribution in Git Commits

‚ùå FORBIDDEN:
- ü§ñ Generated with Claude Code
- Co-Authored-By: Claude

‚úÖ REQUIRED:
- Clean, professional commit messages
- Conventional commit format
```

---

### 7. Configuration CI/CD

**Objectif¬†:** Mettre en place des workflows d'int√©gration continue

**Fournisseurs pris en charge¬†:**
- Actions GitHub (`.github/workflows/ci.yml`)
- GitLab CI (`.gitlab-ci.yml`)
- CercleCI (`.circleci/config.yml`)

**Commandes configurables¬†:**
- Installer en fonctioncies
- Ex√©cuter des tests
- Ex√©cuter le linter
- Ex√©cuter le v√©rificateur de type
- Construire un projet

**Options¬†:**
```
CI provider:         GitHub Actions / GitLab CI / CircleCI
Commands to run:     install, test, lint, type-check, build (multiselect)
Test locally:        Yes / No
Trigger remote CI:   Yes / No
```

---

### 8. Configuration du contr√¥le des dommages

**Objectif¬†:** Prot√©gez votre base de code des commandes destructrices

Voir [Damage Control](/docs/features/damage-control) pour une documentation compl√®te.

**Niveaux de protection¬†:**
- **Standard** - Correspondance rapide des motifs, plus de 40¬†motifs
- **Am√©lior√©** - √âvaluation standard + IA
- **Minimal** - Protection du chemin uniquement

**Options¬†:**
```
Protection level:    Standard / Enhanced / Minimal
Custom protections:  Prod DB / Cloud CLI / Env files (multiselect)
```

---

### 9. Agent de v√©rification

**Objectif¬†:** Tester et valider le bon fonctionnement des configurations

**Ce qu'il valide¬†:**
- Syntaxe du fichier JSON (param√®tres, m√©tadonn√©es)
- Ex√©cution du script Hook
-Syntaxe du flux de travail YAML
- Commandes CI (tests locaux)
- Connexions √† distance

**Gestion des jetons¬†:**
- Stocke les jetons dans `.claude/settings.local.json` (gitignored)
- Prend en charge les jetons GitHub, GitLab, CircleCI
- Ne fait jamais √©cho aux jetons sur la console

---

## Organisation des fichiers

```
project/
‚îú‚îÄ‚îÄ .github/workflows/ci.yml          # GitHub Actions
‚îú‚îÄ‚îÄ .claude/
‚îÇ   ‚îú‚îÄ‚îÄ settings.json                 # Hooks & status line (committed)
‚îÇ   ‚îú‚îÄ‚îÄ settings.local.json           # User overrides (gitignored)
‚îÇ   ‚îî‚îÄ‚îÄ settings.local.example.json   # Template for team
‚îú‚îÄ‚îÄ .agileflow/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ damage-control-patterns.yaml
‚îÇ   ‚îî‚îÄ‚îÄ scripts/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ agileflow-welcome.js
‚îÇ   ‚îú‚îÄ‚îÄ agileflow-statusline.sh
‚îÇ   ‚îî‚îÄ‚îÄ precompact-context.sh
‚îú‚îÄ‚îÄ CLAUDE.md                         # Project guidelines
‚îî‚îÄ‚îÄ docs/00-meta/
    ‚îî‚îÄ‚îÄ agileflow-metadata.json       # Configuration metadata
```

## R√®gles Gitignore

**Engag√© (configuration de l'√©quipe)¬†:**
- `.claude/settings.json`
- `.claude/settings.local.example.json`
- `.github/workflows/`
- `CLAUDE.md`
- `scripts/`
- `.agileflow/`

**Gitignored (sp√©cifique √† l'utilisateur)¬†:**
- `.claude/settings.local.json`
- `.claude/prompt-log.txt`
- `.claude/*.log`

## R√©f√©rence du jeton

### Jeton GitHub (ghp_xxx)
- **Emplacement¬†:** `.claude/settings.local.json`
-¬†**√âtendues n√©cessaires¬†:** `repo`, `workflow`
- **Cr√©er sur¬†:** https://github.com/settings/tokens/new

### Jeton GitLab (glpat_xxx)
- **Emplacement¬†:** `.claude/settings.local.json`
- **√âtendues n√©cessaires¬†:** `api`, `read_repository`, `write_repository`
- **Cr√©er sur¬†:** https://gitlab.com/-/profile/personal_access_tokens

### Jeton CircleCI
- **Emplacement¬†:** `.claude/settings.local.json`
- **Cr√©er sur¬†:** https://app.circleci.com/settings/user/tokens

## D√©pannage

| Probl√®me | Parce que | Solutions |
|---------|-------|----------|
| La configuration ne prend pas effet | Claude Code non red√©marr√© | Quittez (Cmd+Q) et red√©marrez |
| L'authentification du jeton √©choue | Jeton expir√©/invalide | R√©g√©n√©rer chez le fournisseur |
| Erreur de syntaxe YAML | Fichier de flux de travail invalide |Valider avec yamllint |
| status.json trop grand | D√©passe la limite de jetons | Activer l'archivage (3-7 jours) |
| Les crochets ne fonctionnent pas | settings.json invalide | V√©rifiez JSON avec `jq` |
| Ligne d'√©tat manquante | Script non ex√©cutable | `chmod +x scripts/*.sh` |

### Exigence de red√©marrage

Ces agents n√©cessitent le **red√©marrage de Claude¬†Code**¬†:
- des crochets
- pr√©compact
- ligne d'√©tat
- contr√¥le des d√©g√¢ts

```bash
# Complete quit (not just closing window)
Cmd+Q (Mac) or Ctrl+Q (Windows/Linux)
# Wait 5 seconds, then reopen
```

### Restauration

```bash
# Restore from git
git checkout .claude/settings.json

# Remove problematic hook
jq 'del(.hooks.HookName)' .claude/settings.json > tmp.json && mv tmp.json .claude/settings.json

# Disable all hooks
jq 'del(.hooks)' .claude/settings.json > tmp.json && mv tmp.json .claude/settings.json
```

## Sc√©narios courants

### Nouvelle configuration du projet
```bash
/agileflow:configure  # Select: Git Repository
/agileflow:configure  # Select: Hooks System
/agileflow:configure  # Select: Damage Control
/agileflow:configure  # Select: Verification
```

### Ajouter CI/CD
```bash
/agileflow:configure  # Select: CI/CD Workflow
# Choose provider, commands, test locally
git add .github/workflows/ci.yml
git commit -m "ci: add GitHub Actions workflow"
```

### Optimiser pour les grands projets
```bash
/agileflow:configure  # Select: Archival (7-14 days)
/agileflow:configure  # Select: Status Line
/agileflow:configure  # Select: PreCompact
```