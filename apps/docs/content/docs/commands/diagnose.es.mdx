---
title: /diagnosticar
description: System health diagnostics
---

# /diagnosticar

Ejecute comprobaciones integrales del estado del sistema AgileFlow para identificar problemas potenciales antes de que causen fallas.

## Inicio r√°pido

```bash
/agileflow:diagnose
```

Esto realiza un conjunto de diagn√≥stico completo sin necesidad de argumentos.

## Par√°metros

Este comando no requiere par√°metros: ejecuta autom√°ticamente todas las comprobaciones de diagn√≥stico.

## Lo que comprueba

El sistema de diagn√≥stico valida toda su instalaci√≥n de AgileFlow:

### 1. Validaci√≥n de archivos JSON
- Valida todos los archivos JSON cr√≠ticos (status.json, metadatos, configuraci√≥n)
- Comprueba el formato y la estructura del archivo.
- Tama√±os de archivos de informes en KB
- Advierte si status.json supera los 100 KB (se recomienda archivarlo)
- Muestra recuentos de historias en archivos activos y archivados.

### 2. Integridad de la estructura de archivos
- Verifica que existan los directorios requeridos (docs/, .agileflow/, .claude/)
- Comprueba archivos cr√≠ticos (metadata.json, status.json)
- Distingue entre archivos cr√≠ticos y opcionales.

### 3. Sistema de Autoarchivo
- Comprueba si el script de archivo existe y es ejecutable
- Verifica la configuraci√≥n del enlace en .claude/settings.json
- Umbral de archivo de informes a partir de metadatos
- Identifica componentes faltantes o mal configurados

### 4. Sistema de ganchos
- Valida la estructura .claude/settings.json
- Cuenta los ganchos SessionStart, UserPromptSubmit y Stop
- Informa problemas de configuraci√≥n
- Comprueba la ejecutabilidad del gancho

### 5. An√°lisis del tama√±o del archivo
- Supervisa el tama√±o de status.json con umbrales
- Muestra recuentos de historias activas y archivadas.
- Recomienda archivar cuando sea necesario.
- Proporciona recomendaciones basadas en el tama√±o.

## Ejemplos

### Diagn√≥stico B√°sico

```bash
/agileflow:diagnose
```

Ejecuta una verificaci√≥n completa del estado del sistema y muestra los resultados.

### Indicadores de resultados

El diagn√≥stico utiliza estos indicadores de estado:
- **‚úÖ** (marca de verificaci√≥n): control de salud aprobado
- **‚ùå** (cruz): la comprobaci√≥n de estado fall√≥
- **‚ö†Ô∏è** (advertencia): Se encontr√≥ un problema no cr√≠tico
- **‚ÑπÔ∏è** (info): Estado informativo

## Salida t√≠pica

```text
üîç AgileFlow System Diagnostics
================================

üìã JSON File Validation
----------------------
  ‚úÖ docs/00-meta/agileflow-metadata.json (42KB)
  ‚úÖ docs/09-agents/status.json (28KB, 12 stories)
  ‚ÑπÔ∏è  docs/09-agents/status-archive.json - not found (optional)
  ‚úÖ .claude/settings.json (5KB)

üì¶ Auto-Archival System
----------------------
  ‚úÖ Archive script exists and is executable
  ‚úÖ Auto-archival hook configured
  ‚úÖ Archival threshold: 7 days

ü™ù Hooks System
---------------
  ‚úÖ .claude/settings.json is valid JSON
  ‚ÑπÔ∏è  SessionStart hooks: 2
  ‚ÑπÔ∏è  UserPromptSubmit hooks: 1
  ‚ÑπÔ∏è  Stop hooks: 1

üìè File Size Analysis
---------------------
  status.json: 28KB (12 stories)
  ‚úÖ status.json size is healthy

üìä Diagnostic Summary
=====================
‚úÖ All checks passed! System is healthy.
```

## Problemas comunes detectados

| Issue | Indicator | Solution |
|-------|-----------|----------|
| Invalid JSON syntax | ‚ùå | Fix JSON using `jq . <file>` to identify errors |
| Large status.json (>100KB) | ‚ö†Ô∏è | Run archival to reduce file size |
| Missing critical files | ‚ùå | Run `npx agileflow setup` to recreate |
| Archive script not executable | ‚ö†Ô∏è | Run `chmod +x scripts/archive-completed-stories.sh` |
| Archival hook not configured | ‚ùå | Run `/agileflow:configure --enable=archival` |
| Invalid .claude/settings.json | ‚ùå | Run `/agileflow:configure --migrate` to fix format |

## Cuando correr

Ejecutar diagn√≥stico:
- **After setup**: Verifique que la instalaci√≥n de AgileFlow se haya completado correctamente
- **Before major operations**: Verifique el estado del sistema antes de grandes cambios
- **Periodically**: Ejecutar mensualmente/trimestralmente para mantener la salud del sistema.
- **After configuration changes**: Verifique que los cambios surtieron efecto correctamente
- **On startup**: Si tiene problemas, comience aqu√≠ para solucionarlos

## C√≥digos de salida

- **0**: Todas las comprobaciones pasaron, el sistema est√° en buen estado
- **1**: Se encontraron uno o m√°s problemas que necesitan atenci√≥n.

Esto permite que el comando se utilice en canalizaciones de CI/CD y scripts automatizados.

## Acciones recomendadas

Si se encuentran problemas, siga estos pasos:

1. **Invalid JSON**: Usar `jq . <file>` para identificar y corregir errores de sintaxis manualmente
2. **Large files**: Ejecutar archivo: `bash scripts/archive-completed-stories.sh`
3. **Missing files**: Reinstalar: `npx agileflow setup`
4. **Format issues**: Ejecutar migraci√≥n: `/agileflow:configure --migrate`
5. **Re-run diagnostics**: Verifique que los problemas est√©n resueltos

## Comandos relacionados

- [`/configurar`](/commands/configure) - Configurar las funciones de AgileFlow
- [`/validar-experiencia`](/commands/validate-expertise) - Validar archivos de experiencia.
- [`/comprimir`](/commands/compress) - Comprime status.json y reduce el tama√±o del archivo.
