---
title: "/Kompresse"
description: Komprimieren Sie status.json, indem Sie ausf√ºhrliche Felder entfernen und nur Tracking-Metadaten beibehalten
---

# /Kompresse

Reduzieren Sie die Gr√∂√üe der Datei ‚Äûstatus.json‚Äú, indem Sie ausf√ºhrliche Story-Felder entfernen und gleichzeitig alle wichtigen Tracking-Metadaten sowie vollst√§ndige Story-Details in Markdown-Dateien beibehalten.

## Schnellstart

```bash
/agileflow:compress
```

## Zweck

Dieser Befehl l√∂st ein h√§ufiges Problem: wann `status.json` Wird der Wert gr√∂√üer (insbesondere bei gro√üen Projekten mit mehr als 100 Storys), kann er die Token-Grenzwerte √ºberschreiten und die Agentenverarbeitung verlangsamen. Der Komprimierungsbefehl:
- Entfernt ausf√ºhrliche Felder (Beschreibungen, AC, Architekturkontext usw.)
- Beh√§lt nur wesentliche Tracking-Metadaten (Story-ID, Status, Besitzer, Zeitstempel)
- Reduziert die Dateigr√∂√üe normalerweise um 80‚Äì90 %
- Beh√§lt den gesamten Story-Inhalt in Markdown-Dateien bei
- Beh√§lt den vollst√§ndigen Projektverlauf bei
- Stellt sicher, dass Agenten status.json effizient lesen k√∂nnen

## Parameter

Dieser Befehl hat keine Parameter ‚Äì er wird direkt ausgef√ºhrt `docs/09-agents/status.json`.

## Verwendung

F√ºhren Sie einfach Folgendes aus:

```bash
/agileflow:compress
```

Der Befehl wird:
1. √úberpr√ºfen Sie, ob status.json vorhanden ist und g√ºltiges JSON ist
2. Vor Statistiken anzeigen (Gr√∂√üe, Zeilen, Anzahl der Geschichten)
3. Erstellen Sie ein automatisches Backup
4. Ausf√ºhrliche Felder entfernen
5. Komprimierte Version schreiben
6. Nach Statistiken und Einsparungen anzeigen

## Was entfernt wird

Diese ausf√ºhrlichen Felder wurden aus status.json entfernt:

```text
- description          # Story description and context
- acceptanceCriteria   # AC bullet points
- architectureContext  # Architecture details
- technicalNotes       # Implementation hints
- testingStrategy      # Test approach
- devAgentRecord       # Implementation notes
- previousStoryInsights # Lessons from previous story
- (all other large text fields)
```

Diese werden sicher aufbewahrt `docs/06-stories/` stattdessen Markdown-Dateien.

## Was bleibt erhalten

In status.json verbleiben nur die wesentlichen Tracking-Metadaten:

```text
- story_id            # Story identifier
- epic                # Parent epic
- title               # Story title
- owner               # Assigned agent
- status              # Current status (ready/in-progress/blocked/done)
- estimate            # Time estimate
- created             # Creation timestamp
- updated             # Last update timestamp
- completed_at        # Completion timestamp
- dependencies        # Dependent story IDs
- branch              # Git branch name
- summary             # Short summary
- last_update         # Last modification message
- assigned_at         # Assignment timestamp
```

## Beispielausgabe

```text
üóúÔ∏è  AgileFlow Status Compression
   Purpose: Strip verbose fields from status.json
   Target: Keep only essential tracking metadata

üíæ Backup created: docs/09-agents/status.json.backup

üìä Before Compression:
   Stories: 145
   Size: 384KB
   Lines: 12,847

‚úÖ Compression complete!

üìä After Compression:
   Stories: 145 (unchanged)
   Size: 384KB ‚Üí 42KB
   Lines: 12,847 ‚Üí 1,203
   Saved: 89% (342KB)

‚úÖ Estimated tokens: ~10,500 (safely under 25000 limit)

üìã Status Summary:
   ready: 23 stories
   in-progress: 8 stories
   blocked: 2 stories
   done: 112 stories

üíæ To restore original: cp docs/09-agents/status.json.backup docs/09-agents/status.json
```

## Wann zu verwenden

### Verwenden Sie Komprimierung, wenn:

1. **status.json exceeds 25,000 tokens**
   - Agenten schlagen mit ‚ÄûDateiinhalt √ºberschreitet maximal zul√§ssige Token‚Äú fehl.

2. **File is slow to process**
   - Zu gro√ü f√ºr Kontextfenster
   - Verursacht Zeit√ºberschreitungsprobleme

3. **After major epic completion**
   - Viele abgeschlossene Geschichten mit ausf√ºhrlichen Aufzeichnungen
   - Das Projekt ist erheblich gewachsen

4. **Quarterly maintenance**
   - Regelm√§√üige Aufr√§umarbeiten, um den √úberblick zu behalten

### Alternative: Mit Archival kombinieren

F√ºr noch bessere Ergebnisse kombinieren Sie Komprimierung mit Archivierung:

```bash
# Step 1: Archive completed stories older than 3 days
bash .agileflow/scripts/archive-completed-stories.sh 3

# Step 2: Compress remaining stories
/agileflow:compress
```

Durch diesen zweistufigen Prozess wird eine maximale Reduzierung bei gleichzeitiger Beibehaltung der Historie erreicht.

## Sicherheit und Backups

### Automatische Sicherung

Vor der Komprimierung erstellt der Befehl ein Backup:
```text
docs/09-agents/status.json.backup
```

### Kein Datenverlust

- Der vollst√§ndige Inhalt der Story bleibt erhalten `docs/06-stories/` Markdown-Dateien
- Story-Markdown-Dateien werden NICHT ge√§ndert
- Nur der status.json-Index wird komprimiert
- Kann jederzeit aus dem Backup wiederhergestellt werden

### Bei Bedarf wiederherstellen

```bash
cp docs/09-agents/status.json.backup docs/09-agents/status.json
```

Das Backup enth√§lt die komplette Originaldatei.

## Warum diese Architektur?

### Trennung von Belangen

**status.json** = leichter Tracking-Index
- ‚ÄûWelche Geschichten gibt es?‚Äú
- ‚ÄûWem geh√∂rt jede Geschichte?‚Äú
- ‚ÄûWie ist der aktuelle Stand?‚Äú
- ‚ÄûWann wurde es aktualisiert?‚Äú

**docs/06-stories/** = vollst√§ndiger Story-Inhalt
- Vollst√§ndige Beschreibungen
- Akzeptanzkriterien
- Architekturentscheidungen
- Hinweise zur Implementierung
- Teststrategien

**docs/09-agents/archive/** = historische Daten
- Abgeschlossene Geschichten, die √§lter als der Schwellenwert sind
- Monatliche Organisation
- Volle Abruff√§higkeit

### Vorteile

1. **Fast Indexing** ‚Äì Agenten lesen status.json schnell
2. **Complete Content** - Vollst√§ndige Details im Story-Markdown
3. **Searchable** - Kann Story-Dateien nach Inhalt durchsuchen
4. **Versionable** - Alle Dateien werden von Git verfolgt
5. **Archivable** - Alte Geschichten bl√§hen den Tracking-Index nicht auf

## Token-Sch√§tzung

Der Befehl sch√§tzt die Token-Nutzung:

```text
Token estimation formula: tokens ‚âà bytes / 4

Before: 384KB √ó 1024 bytes/KB √∑ 4 = 98,304 tokens
After: 42KB √ó 1024 bytes/KB √∑ 4 = 10,752 tokens

Saved: 87,552 tokens!
```

Ziel: Halten Sie status.json unter 25.000 Token (100 KB komprimiert).

## Workflow-Integration

### Mit Agent Bus

Die status.json-Komprimierung hat keine Auswirkungen auf Folgendes:
- Agent-Nachrichtenbus (`docs/09-agents/bus/log.jsonl`)
- Agentenkommunikation und -koordination
- Verfolgung des Story-Status

### Mit CI/CD

Komprimierung kann zur CI-Automatisierung hinzugef√ºgt werden:

```yaml
name: Maintenance
on:
  schedule:
    - cron: '0 2 * * 0'  # Sunday 2am UTC

jobs:
  compress:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Archive and compress
        run: |
          bash .agileflow/scripts/archive-completed-stories.sh 3
          /agileflow:compress
      - name: Commit if changed
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add docs/09-agents/
          git diff --quiet && git diff --staged --quiet || \
          git commit -m "chore(maintenance): archive and compress status"
          git push
```

## H√§ufige Szenarien

### Szenario 1: Projekt wird gr√∂√üer

**Problem**: status.json ist 250 KB gro√ü und hat 150 Geschichten
**Solution**:
```bash
/agileflow:compress
```
**Result**: Reduziert sich auf 30 KB und liegt problemlos unter den Token-Grenzwerten

### Szenario 2: Viele abgeschlossene Geschichten

**Problem**: 120 abgeschlossene, 30 aktive Geschichten; status.json aufgebl√§ht
**Solution**:
```bash
# Archive stories completed >7 days ago
bash .agileflow/scripts/archive-completed-stories.sh 7

# Then compress
/agileflow:compress
```
**Result**: Verschiebt alte Geschichten ins Archiv, komprimiert die verbleibenden

### Szenario 3: Regelm√§√üige Wartung

**Problem**: M√∂chten Sie status.json automatisch schlank halten?
**Solution**: Zum CI-Zeitplan hinzuf√ºgen (monatliche Komprimierung)
**Result**: Immer unter Token-Grenzwerten, schnelle Agentenverarbeitung

## Fehlerbehebung

### ‚Äûstatus.json nach der Komprimierung immer noch zu gro√ü‚Äú

Versuchen Sie es mit einer aggressiveren Archivierung:
```bash
# Archive stories >3 days old instead of default 7
bash .agileflow/scripts/archive-completed-stories.sh 3

/agileflow:compress
```

### ‚ÄûKritische Informationen nach Komprimierung verloren‚Äú

Aus Backup wiederherstellen:
```bash
cp docs/09-agents/status.json.backup docs/09-agents/status.json
```

√úberpr√ºfen Sie, ob die Story-Markdown-Dateien die Details enthalten `docs/06-stories/`.

### ‚ÄûKann keine Story-Details finden‚Äú

Der Story-Inhalt befindet sich in Markdown-Dateien:
```bash
find docs/06-stories/ -name "US-*.md" | xargs grep "your search term"
```

## Best Practices

1. **Regular Compression** - Monatlich oder viertelj√§hrlich ausf√ºhren
2. **Archive Aggressively** - Verschieben Sie zuerst alte abgeschlossene Geschichten
3. **Back Up Before** - Durch die Komprimierung wird automatisch ein Backup erstellt
4. **Verify After** - √úberpr√ºfen Sie die Token-Sch√§tzung in der Ausgabe
5. **Commit Changes** - Komprimierten Status zu Git hinzuf√ºgen
6. **Document Policy** - Zeichnen Sie auf, wann/warum die Komprimierung ausgef√ºhrt wird
7. **Test Restoration** - √úberpr√ºfen Sie bei Bedarf, ob die Sicherung funktioniert

## Verwandte Befehle

- [`/agileflow:status`](/commands/status) - Aktuelle Story-Status anzeigen
- [`/agileflow:validate`](/commands/validate) - √úberpr√ºfen Sie den Zustand des AgileFlow-Systems
- Archivskript: `bash .agileflow/scripts/archive-completed-stories.sh` - Verschieben Sie abgeschlossene Geschichten ins Archiv

## Technische Details

### Beteiligte Dateien

| File | Purpose |
|------|---------|
| `docs/09-agents/status.json` | Lightweight tracking index (compressed) |
| `docs/09-agents/status.json.backup` | Automatic backup before compression |
| `docs/06-stories/` | Full story markdown files (unchanged) |
| `docs/09-agents/archive/YYYY-MM.json` | Historical completed stories |

### Durchf√ºhrung

Das Komprimierungsskript verwendet `jq` f√ºr die JSON-Verarbeitung:

```bash
# Extract only essential fields for each story
jq '[.[] | {story_id, epic, title, owner, status, estimate, created, updated, completed_at, dependencies, branch, summary, last_update, assigned_at}]' status.json > status-compressed.json
```

### Token-Berechnung

In der Ausgabe verwendete grobe Sch√§tzung:
- 1 Token ‚âà 4 Zeichen/Bytes (ungef√§hr)
- 100-KB-Datei ‚âà 25.000 Token
- Ziel: \< 100 KB, um deutlich unter den Grenzwerten zu bleiben

## FAQ

<Accordion type="multiple">
  <AccordionItem value="delete">
    <AccordionTrigger>Does compression delete story files?</AccordionTrigger>
    <AccordionContent>
      Nein. Nur status.json wird ge√§ndert. Der Story-Markdown in docs/06-stories/ bleibt unber√ºhrt.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="undo">
    <AccordionTrigger>Can I undo compression?</AccordionTrigger>
    <AccordionContent>
      Ja. Es wird automatisch ein Backup erstellt. Einfach wiederherstellen: `cp docs/09-agents/status.json.backup docs/09-agents/status.json`
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="when">
    <AccordionTrigger>When should I compress?</AccordionTrigger>
    <AccordionContent>
      Wenn status.json 25 KB √ºberschreitet, oder monatlich als Wartung. F√ºr beste Ergebnisse mit Archivmaterial kombinieren.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="performance">
    <AccordionTrigger>Does this affect agent performance?</AccordionTrigger>
    <AccordionContent>
      Ja, verbessert es dramatisch. Kleinere status.json = schnellere Lesevorg√§nge, mehr verf√ºgbarer Kontext f√ºr Agenten.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="git">
    <AccordionTrigger>What about git history?</AccordionTrigger>
    <AccordionContent>
      Alle √Ñnderungen werden √ºbernommen. Fr√ºhere Versionen befinden sich bei Bedarf im Git-Verlauf.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="customize">
    <AccordionTrigger>Can I customize which fields to keep?</AccordionTrigger>
    <AccordionContent>
      Ja, bearbeiten Sie das Komprimierungsskript, um bei Bedarf zus√§tzliche Felder f√ºr Ihren Workflow beizubehalten.
    </AccordionContent>
  </AccordionItem>
</Accordion>
