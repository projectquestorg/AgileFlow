---
title: /Kompresse
description: Komprimieren Sie status.json, indem Sie ausf√ºhrliche Felder entfernen und nur Tracking-Metadaten beibehalten
---
# /komprimieren

Reduzieren Sie die Gr√∂√üe der Datei ‚Äûstatus.json‚Äú, indem Sie ausf√ºhrliche Story-Felder entfernen und gleichzeitig alle wichtigen Tracking-Metadaten sowie vollst√§ndige Story-Details in Markdown-Dateien beibehalten.

## Schnellstart

```bash
/agileflow:compress
```

## Zweck

Dieser Befehl l√∂st ein h√§ufiges Problem: Wenn `status.json` gro√ü wird (insbesondere bei gro√üen Projekten mit mehr als 100 Storys), kann es die Token-Grenzwerte √ºberschreiten und die Agentenverarbeitung verlangsamen. Der Komprimierungsbefehl:
- Entfernt ausf√ºhrliche Felder (Beschreibungen, AC, Architekturkontext usw.)
- Beh√§lt nur wesentliche Tracking-Metadaten (Story-ID, Status, Besitzer, Zeitstempel)
- Reduziert die Dateigr√∂√üe normalerweise um 80‚Äì90 %
- Beh√§lt den gesamten Story-Inhalt in Markdown-Dateien bei
- Beh√§lt den vollst√§ndigen Projektverlauf bei
‚Äì Stellt sicher, dass Agenten status.json effizient lesen k√∂nnen

## Parameter

Dieser Befehl hat keine Parameter ‚Äì er wird direkt auf `docs/09-agents/status.json` angewendet.

## Nutzung

F√ºhren Sie einfach Folgendes aus:

```bash
/agileflow:compress
```

Der Befehl wird:
1. √úberpr√ºfen Sie, ob status.json vorhanden ist und ein g√ºltiger JSON-Code ist
2. Vorher Statistiken anzeigen (Gr√∂√üe, Linien, Story Count)
3. Erstellen Sie ein automatisches Backup
4. Entfernen Sie ausf√ºhrliche Felder
5. Komprimierte Version schreiben
6. Nach Statistiken und Einsparungen anzeigen

## Was entfernt wird

Diese ausf√ºhrlichen Felder wurden aus status.json entfernt:

```text
- description          # Story description and context
- acceptanceCriteria   # AC bullet points
- architectureContext  # Architecture details
- technicalNotes       # Implementation hints
- testingStrategy      # Test approach
- devAgentRecord       # Implementation notes
- previousStoryInsights # Lessons from previous story
- (all other large text fields)
```

Diese werden stattdessen sicher in `docs/06-stories/`-Markdown-Dateien gespeichert.

## Was bleibt erhalten

In status.json verbleiben nur die wesentlichen Tracking-Metadaten:

```text
- story_id            # Story identifier
- epic                # Parent epic
- title               # Story title
- owner               # Assigned agent
- status              # Current status (ready/in-progress/blocked/done)
- estimate            # Time estimate
- created             # Creation timestamp
- updated             # Last update timestamp
- completed_at        # Completion timestamp
- dependencies        # Dependent story IDs
- branch              # Git branch name
- summary             # Short summary
- last_update         # Last modification message
- assigned_at         # Assignment timestamp
```

## Beispielausgabe

```text
üóúÔ∏è  AgileFlow Status Compression
   Purpose: Strip verbose fields from status.json
   Target: Keep only essential tracking metadata

üíæ Backup created: docs/09-agents/status.json.backup

üìä Before Compression:
   Stories: 145
   Size: 384KB
   Lines: 12,847

‚úÖ Compression complete!

üìä After Compression:
   Stories: 145 (unchanged)
   Size: 384KB ‚Üí 42KB
   Lines: 12,847 ‚Üí 1,203
   Saved: 89% (342KB)

‚úÖ Estimated tokens: ~10,500 (safely under 25000 limit)

üìã Status Summary:
   ready: 23 stories
   in-progress: 8 stories
   blocked: 2 stories
   done: 112 stories

üíæ To restore original: cp docs/09-agents/status.json.backup docs/09-agents/status.json
```

## Wann zu verwenden

### Komprimierung verwenden, wenn:

1. **status.json √ºberschreitet 25.000 Token**
   ‚Äì Agents schlagen mit ‚ÄûDateiinhalt √ºberschreitet maximal zul√§ssige Token‚Äú fehl.

2. **Datei wird langsam verarbeitet**
   - Zu gro√ü f√ºr Kontextfenster
   ‚Äì Verursacht Zeit√ºberschreitungsprobleme

3. **Nach dem gro√üen epischen Abschluss**
   - Viele abgeschlossene Geschichten mit ausf√ºhrlichen Aufzeichnungen
   - Das Projekt ist erheblich gewachsen

4. **Viertelj√§hrliche Wartung**
   - Regelm√§√üige Bereinigung, um den √úberblick zu behalten

### Alternative: Mit Archival kombinieren

F√ºr noch bessere Ergebnisse kombinieren Sie Komprimierung mit Archivierung:

```bash
# Step 1: Archive completed stories older than 3 days
bash .agileflow/scripts/archive-completed-stories.sh 3

# Step 2: Compress remaining stories
/agileflow:compress
```

Dieser zweistufige ProzessSS erreicht eine maximale Reduzierung bei gleichzeitiger Beibehaltung der Historie.

## Sicherheit und Backups

### Automatische Sicherung

Vor der Komprimierung erstellt der Befehl ein Backup:
```text
docs/09-agents/status.json.backup
```

### Kein Datenverlust

‚Äì Der vollst√§ndige Story-Inhalt verbleibt in den Markdown-Dateien `docs/06-stories/`
- Story-Markdown-Dateien werden NICHT ge√§ndert
‚Äì Nur der status.json-Index wird komprimiert
- Kann jederzeit aus dem Backup wiederhergestellt werden

### Bei Bedarf wiederherstellen

```bash
cp docs/09-agents/status.json.backup docs/09-agents/status.json
```

Das Backup enth√§lt die komplette Originaldatei.

## Warum diese Architektur?

### Trennung von Belangen

**status.json** = Leichter Tracking-Index
- ‚ÄûWelche Geschichten gibt es?‚Äú
- ‚ÄûWem geh√∂rt jede Geschichte?‚Äú
- ‚ÄûWie ist der aktuelle Stand?‚Äú
- ‚ÄûWann wurde es aktualisiert?‚Äú

**docs/06-stories/** = vollst√§ndiger Story-Inhalt
- Vollst√§ndige Beschreibungen
- Akzeptanzkriterien
- Architekturentscheidungen
- Hinweise zur Implementierung
- Teststrategien

**docs/09-agents/archive/** = historische Daten
- Abgeschlossene Geschichten, die √§lter als der Schwellenwert sind
- Monatliche Organisation
- Volle Abruff√§higkeit

### Vorteile

1. **Schnelle Indizierung** ‚Äì Agents lesen Sie status.json schnell
2. **Vollst√§ndiger Inhalt** ‚Äì Vollst√§ndige Details im Story-Markdown
3. **Durchsuchbar** ‚Äì Kann Story-Dateien nach Inhalten durchsuchen
4. **Versionierbar** ‚Äì Alle Dateien werden git-tracked
5. **Archivierbar** ‚Äì Alte Geschichten bl√§hen den Tracking-Index nicht auf

## Token-Sch√§tzung

Der Befehl sch√§tzt die Token-Nutzung:

```text
Token estimation formula: tokens ‚âà bytes / 4

Before: 384KB √ó 1024 bytes/KB √∑ 4 = 98,304 tokens
After: 42KB √ó 1024 bytes/KB √∑ 4 = 10,752 tokens

Saved: 87,552 tokens!
```

Ziel: Halten Sie status.json unter 25.000 Token (100 KB komprimiert).

## Workflow-Integration

### Mit Agent Bus

Die status.json-Komprimierung hat keine Auswirkungen auf Folgendes:
‚Äì Agent-Nachrichtenbus (`docs/09-agents/bus/log.jsonl`)
- Agentenkommunikation und -koordination
- Verfolgung des Story-Status

### Mit CI/CD

Komprimierung kann zur CI-Automatisierung hinzugef√ºgt werden:

```yaml
name: Maintenance
on:
  schedule:
    - cron: '0 2 * * 0'  # Sunday 2am UTC

jobs:
  compress:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Archive and compress
        run: |
          bash .agileflow/scripts/archive-completed-stories.sh 3
          /agileflow:compress
      - name: Commit if changed
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add docs/09-agents/
          git diff --quiet && git diff --staged --quiet || \
          git commit -m "chore(maintenance): archive and compress status"
          git push
```

## H√§ufige Szenarien

### Szenario 1: Projekt wird gr√∂√üer

**Problem**: status.json ist 250 KB gro√ü und hat 150 Storys
**L√∂sung**:
```bash
/agileflow:compress
```
**Ergebnis**: Reduziert sich auf 30 KB und liegt somit problemlos unter den Token-Grenzwerten

### Szenario 2: Viele abgeschlossene Geschichten

**Problem**: 120 abgeschlossene, 30 aktive Geschichten; status.json aufgebl√§ht
**L√∂sung**:
```bash
# Archive stories completed >7 days ago
bash .agileflow/scripts/archive-completed-stories.sh 7

# Then compress
/agileflow:compress
```
**Ergebnis**: Verschiebt alte Storys ins Archiv, komprimiert die verbleibenden

### Szenario 3: Regelm√§√üige Wartung

**Problem**: Sie m√∂chten status.json automatisch schlank halten
**L√∂sung**: Zum CI-Plan hinzuf√ºgen (monatliche Komprimierung)
**Ergebnis**: Immer unter Token-Grenzwerten, schnelle Agentenverarbeitung

## Fehlerbehebung

### ‚Äûstatus.json nach der Komprimierung immer noch zu gro√ü‚Äú

Versuchen Sie es mit einer aggressiveren Archivierung:
```bash
# Archive stories >3 days old instead of default 7
bash .agileflow/scripts/archive-completed-stories.sh 3

/agileflow:compress
```

### ‚ÄûKritische Informationen nach der Komprimierung verloren‚Äú

Aus Backup wiederherstellen:
```bash
cp docs/09-agents/status.json.backup docs/09-agents/status.json
```

√úberpr√ºfen Sie, ob Story-Markdown-Dateien die Details in `docs/06-stories/` enthalten.

### ‚ÄûKann keine Story-Details finden‚Äú

Der Story-Inhalt befindet sich in Markdown-Dateien:
```bash
find docs/06-stories/ -name "US-*.md" | xargs grep "your search term"
```

## Best Practices

1. **Regelm√§√üige Komprimierung** ‚Äì Monatlich oder viertelj√§hrlich ausf√ºhren
2. **Aggressiv archivieren** ‚Äì Verschieben Sie zuerst alte abgeschlossene Geschichten
3. **Sichern vorher** ‚Äì Durch die Komprimierung wird automatisch ein Backup erstellt
4. **√úberpr√ºfen nach** ‚Äì √úberpr√ºfen Sie die Token-Sch√§tzung in der Ausgabe
5. **√Ñnderungen festschreiben** ‚Äì Komprimierten Status zu Git hinzuf√ºgen
6. **Dokumentenrichtlinie** ‚Äì Erfassen Sie, wann/warum Sie kompensierenRession l√§uft
7. **Wiederherstellung testen** ‚Äì √úberpr√ºfen Sie bei Bedarf, ob die Sicherung funktioniert

## Verwandte Befehle

- [`/agileflow:status`](/commands/status) ‚Äì Aktuelle Story-Status anzeigen
- [`/agileflow:validate`](/commands/validate) ‚Äì √úberpr√ºfen Sie den Zustand des AgileFlow-Systems
- Archivskript: `bash .agileflow/scripts/archive-completed-stories.sh` - Abgeschlossene Storys ins Archiv verschieben

## Technische Details

### Beteiligte Dateien

| Datei | Zweck |
|------|---------|
| `docs/09-agents/status.json` | Leichter Tracking-Index (komprimiert) |
| `docs/09-agents/status.json.backup` | Automatisches Backup vor der Komprimierung |
| `docs/06-stories/` | Vollst√§ndige Story-Markdown-Dateien (unver√§ndert) |
| `docs/09-agents/archive/YYYY-MM.json` | Historische abgeschlossene Geschichten |

### Implementierung

Das Komprimierungsskript verwendet `jq` f√ºr die JSON-Verarbeitung:

```bash
# Extract only essential fields for each story
jq '[.[] | {story_id, epic, title, owner, status, estimate, created, updated, completed_at, dependencies, branch, summary, last_update, assigned_at}]' status.json > status-compressed.json
```

### Token-Berechnung

In der Ausgabe verwendete grobe Sch√§tzung:
- 1 Token ‚âà 4 Zeichen/Bytes (ungef√§hr)
- 100-KB-Datei ‚âà 25.000 Token
- Ziel: < 100 KB, um deutlich unter den Grenzwerten zu bleiben

## FAQ

<Accordion type="multiple">
  <AccordionItem value="delete">
    <AccordionTrigger>F√ºhrt eine Komprimierung durchn Story-Dateien l√∂schen?</AccordionTrigger>
    <AccordionContent>
      Nein. Nur status.json wird ge√§ndert. Der Story-Markdown in docs/06-stories/ bleibt unber√ºhrt.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="undo">
    <AccordionTrigger>Kann ich die Komprimierung r√ºckg√§ngig machen?</AccordionTrigger>
    <AccordionContent>
      Ja. Es wird automatisch ein Backup erstellt. Einfach wiederherstellen: `cp docs/09-agents/status.json.backup docs/09-agents/status.json`
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="when">
    <AccordionTrigger>Wann sollte ich komprimieren?</AccordionTrigger>
    <AccordionContent>
      Wenn status.json 25 KB √ºberschreitet, oder monatlich als Wartung. F√ºr beste Ergebnisse mit Archivmaterial kombinieren.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="performance">
    <AccordionTrigger>Beeinflusst dies die Leistung des Agenten?</AccordionTrigger>
    <AccordionContent>
      Ja, verbessert es dramatisch. Kleinere status.json = schnellere Lesevorg√§nge, mehr verf√ºgbarer Kontext f√ºr Agenten.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="git">
    <AccordionTrigger>Wh√ºber Git-Geschichte?</AccordionTrigger>
    <AccordionContent>
      Alle √Ñnderungen werden √ºbernommen. Fr√ºhere Versionen befinden sich bei Bedarf im Git-Verlauf.
    </AccordionContent>
  </AccordionItem>
  <AccordionItem value="customize">
    <AccordionTrigger>Kann ich anpassen, welche Felder beibehalten werden sollen?</AccordionTrigger>
    <AccordionContent>
      Ja, bearbeiten Sie das Komprimierungsskript, um bei Bedarf zus√§tzliche Felder f√ºr Ihren Workflow beizubehalten.
    </AccordionContent>
  </AccordionItem>
</Accordion>