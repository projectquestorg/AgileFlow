---
title: "/diagnosticar"
description: Diagn√≥stico de integridade do sistema
---

# /diagnose

Execute verifica√ß√µes abrangentes de integridade do sistema AgileFlow para identificar poss√≠veis problemas antes que causem falhas.

## In√≠cio r√°pido

```bash
/agileflow:diagnose
```

Isso executa um conjunto completo de diagn√≥sticos sem a necessidade de argumentos.

## Par√¢metros

Este comando n√£o utiliza par√¢metros - ele executa automaticamente todas as verifica√ß√µes de diagn√≥stico.

## O que verifica

O sistema de diagn√≥stico valida toda a instala√ß√£o do AgileFlow:

### 1. Valida√ß√£o de arquivo JSON
- Valida todos os arquivos JSON cr√≠ticos (status.json, metadados, configura√ß√µes)
- Verifica o formato e a estrutura do arquivo
- Informa tamanhos de arquivo em KB
- Avisa se status.json exceder 100 KB (recomenda arquivamento)
- Mostra contagens de hist√≥rias em arquivos ativos e arquivados

### 2. Integridade da estrutura de arquivos
- Verifica se existem diret√≥rios necess√°rios (docs/, .agileflow/, .claude/)
- Verifica arquivos cr√≠ticos (metadata.json, status.json)
- Distingue entre arquivos cr√≠ticos e opcionais

### 3. Sistema de arquivamento autom√°tico
- Verifica se o script de arquivo existe e √© execut√°vel
- Verifica a configura√ß√£o do gancho em .claude/settings.json
- Limite de arquivamento de relat√≥rios de metadados
- Identifica componentes ausentes ou mal configurados

### 4. Sistema de ganchos
- Validates .claude/settings.json structure
- Conta os ganchos SessionStart, UserPromptSubmit e Stop
- Relata problemas de configura√ß√£o
- Verifica a executabilidade do gancho

### 5. An√°lise do tamanho do arquivo
- Monitora o tamanho do status.json com limites
- Mostra contagens de hist√≥rias ativas e arquivadas
- Recomenda arquivamento quando necess√°rio
- Fornece recomenda√ß√µes baseadas em tamanho

## Exemplos

### Diagn√≥stico B√°sico

```bash
/agileflow:diagnose
```

Executa uma verifica√ß√£o completa da integridade do sistema e exibe os resultados.

### Indicadores de resultados

O diagn√≥stico usa estes indicadores de status:
- **‚úÖ** (marca de sele√ß√£o): verifica√ß√£o de integridade aprovada
- **‚ùå** (cruz): falha na verifica√ß√£o de integridade
- **‚ö†Ô∏è** (aviso): Problema n√£o cr√≠tico encontrado
- **‚ÑπÔ∏è** (informa√ß√µes): Status informativo

## Sa√≠da t√≠pica

```text
üîç AgileFlow System Diagnostics
================================

üìã JSON File Validation
----------------------
  ‚úÖ docs/00-meta/agileflow-metadata.json (42KB)
  ‚úÖ docs/09-agents/status.json (28KB, 12 stories)
  ‚ÑπÔ∏è  docs/09-agents/status-archive.json - not found (optional)
  ‚úÖ .claude/settings.json (5KB)

üì¶ Auto-Archival System
----------------------
  ‚úÖ Archive script exists and is executable
  ‚úÖ Auto-archival hook configured
  ‚úÖ Archival threshold: 7 days

ü™ù Hooks System
---------------
  ‚úÖ .claude/settings.json is valid JSON
  ‚ÑπÔ∏è  SessionStart hooks: 2
  ‚ÑπÔ∏è  UserPromptSubmit hooks: 1
  ‚ÑπÔ∏è  Stop hooks: 1

üìè File Size Analysis
---------------------
  status.json: 28KB (12 stories)
  ‚úÖ status.json size is healthy

üìä Diagnostic Summary
=====================
‚úÖ All checks passed! System is healthy.
```

## Problemas comuns detectados

| Issue | Indicator | Solution |
|-------|-----------|----------|
| Invalid JSON syntax | ‚ùå | Fix JSON using `jq . <file>` to identify errors |
| Large status.json (>100KB) | ‚ö†Ô∏è | Run archival to reduce file size |
| Missing critical files | ‚ùå | Run `npx agileflow setup` to recreate |
| Archive script not executable | ‚ö†Ô∏è | Run `chmod +x scripts/archive-completed-stories.sh` |
| Archival hook not configured | ‚ùå | Run `/agileflow:configure --enable=archival` |
| Invalid .claude/settings.json | ‚ùå | Run `/agileflow:configure --migrate` to fix format |

## Quando correr

Execute o diagn√≥stico:
- **After setup**: Verifique se a instala√ß√£o do AgileFlow foi conclu√≠da com √™xito
- **Before major operations**: Verifique a integridade do sistema antes de grandes altera√ß√µes
- **Periodically**: Execute mensalmente/trimestralmente para manter a integridade do sistema
- **After configuration changes**: Verifique se as altera√ß√µes entraram em vigor corretamente
- **On startup**: Se tiver problemas, comece aqui para solucionar problemas

## C√≥digos de sa√≠da

- **0**: Todas as verifica√ß√µes foram aprovadas, o sistema est√° √≠ntegro
- **1**: Um ou mais problemas encontrados que precisam de aten√ß√£o

Isso permite que o comando seja usado em pipelines de CI/CD e scripts automatizados.

## A√ß√µes recomendadas

Se forem encontrados problemas, siga estas etapas:

1. **Invalid JSON**: Usar `jq . <file>` para identificar e corrigir erros de sintaxe manualmente
2. **Large files**: Executar arquivamento: `bash scripts/archive-completed-stories.sh`
3. **Missing files**: Reinstale: `npx agileflow setup`
4. **Format issues**: Execute a migra√ß√£o: `/agileflow:configure --migrate`
5. **Re-run diagnostics**: Verifique se os problemas foram resolvidos

## Comandos Relacionados

- [`/configurar`](/commands/configure) - Configurar recursos do AgileFlow
- [`/validar-expertise`](/commands/validate-expertise) - Validar arquivos de experi√™ncia
- [`/comprimir`](/commands/compress) - Compacte status.json e reduza o tamanho do arquivo
