---
title: /diagnostiquer
description: Diagnostic de l'Ã©tat du systÃ¨me
---
# /diagnostiquer

ExÃ©cutez des vÃ©rifications complÃ¨tes de lâ€™Ã©tat du systÃ¨me AgileFlow pour identifier les problÃ¨mes potentiels avant quâ€™ils ne provoquent des pannes.

## DÃ©marrage rapide

```bash
/agileflow:diagnose
```

Cela effectue une suite de diagnostics complÃ¨te sans aucun argument requis.

## ParamÃ¨tres

Cette commande ne prend aucun paramÃ¨treÂ : elle exÃ©cute automatiquement toutes les vÃ©rifications de diagnostic.

## Ce qu'il vÃ©rifie

Le systÃ¨me de diagnostic valide l'intÃ©gralitÃ© de votre installation AgileFlowÂ :

### 1. Validation des fichiers JSON
- Valide tous les fichiers JSON critiques (status.json, mÃ©tadonnÃ©es, paramÃ¨tres)
- VÃ©rifie le format et la structure du fichier
- Rapporte la taille des fichiers en Ko
- Avertit si status.json dÃ©passe 100 Ko (recommande l'archivage)
- Affiche le nombre d'histoires dans les fichiers actifs et archivÃ©s

### 2. IntÃ©gritÃ© de la structure des fichiers
- VÃ©rifie que les rÃ©pertoires requis existent (docs/, .agileflow/, .claude/)
- VÃ©rifie les fichiers critiques (metadata.json, status.json)
- Fait la distinction entre les fichiers critiques et facultatifs

### 3. SystÃ¨me d'archivage automatique
- VÃ©rifie si le script d'archive existe et est exÃ©cutable
- VÃ©rifie la configuration du hook in .claude/settings.json
- Rapporte le seuil d'archivage Ã  partir des mÃ©tadonnÃ©es
- Identifie les composants manquants ou mal configurÃ©s

### 4. SystÃ¨me de crochets
- Valide la structure .claude/settings.json
- Compte les hooks SessionStart, UserPromptSubmit et Stop
- Signale les problÃ¨mes de configuration
- VÃ©rifie l'exÃ©cutabilitÃ© du hook

### 5. Analyse de la taille du fichier
- Surveille la taille de status.json avec des seuils
- Affiche le nombre d'histoires actives et archivÃ©es
- Recommande l'archivage en cas de besoin
- Fournit des recommandations basÃ©es sur la taille

## Exemples

### Diagnostics de base

```bash
/agileflow:diagnose
```

ExÃ©cute un contrÃ´le de santÃ© complet du systÃ¨me et affiche les rÃ©sultats.

### Indicateurs de sortie

Le diagnostic utilise ces indicateurs d'Ã©tatÂ :
- **âœ…** (coche)Â : Bilan de santÃ© rÃ©ussi
- **âŒ** (croix)Â : Ã©chec du contrÃ´le de santÃ©
- **âš ï¸** (avertissement)Â : problÃ¨me non critique dÃ©tectÃ©
- **â„¹ï¸** (info) : Statut informatif

## Sortie typique

```text
ğŸ” AgileFlow System Diagnostics
================================

ğŸ“‹ JSON File Validation
----------------------
  âœ… docs/00-meta/agileflow-metadata.json (42KB)
  âœ… docs/09-agents/status.json (28KB, 12 stories)
  â„¹ï¸  docs/09-agents/status-archive.json - not found (optional)
  âœ… .claude/settings.json (5KB)

ğŸ“¦ Auto-Archival System
----------------------
  âœ… Archive script exists and is executable
  âœ… Auto-archival hook configured
  âœ… Archival threshold: 7 days

ğŸª Hooks System
---------------
  âœ… .claude/settings.json is valid JSON
  â„¹ï¸  SessionStart hooks: 2
  â„¹ï¸  UserPromptSubmit hooks: 1
  â„¹ï¸  Stop hooks: 1

ğŸ“ File Size Analysis
---------------------
  status.json: 28KB (12 stories)
  âœ… status.json size is healthy

ğŸ“Š Diagnostic Summary
=====================
âœ… All checks passed! System is healthy.
```

## ProblÃ¨mes courants dÃ©tectÃ©s

| ProblÃ¨me | Indicateur | Solutions |
|-------|-----------|--------------|
| Syntaxe JSON invalide | âŒ | Corrigez JSON en utilisant `jq . <file>` pour identifier les erreurs |
| Grand status.json (> 100 Ko) | âš ï¸ | ExÃ©cuter l'archivage pour rÃ©duire la taille du fichier |
| Fichiers critiques manquants | âŒ | ExÃ©cutez `npx agileflow setup` pour recrÃ©er |
| Script d'archive non exÃ©cutable | âš ï¸ | ExÃ©cutez `chmod +x scripts/archive-completed-stories.sh` |
| Hook d'archivage non configurÃ© | âŒ | ExÃ©cutez `/agileflow:configure --enable=archival` |
| .claude/settings.json invalide | âŒ | ExÃ©cutez `/agileflow:configure --migrate` pour corriger le format |

## Quand exÃ©cuter

ExÃ©cutez des diagnosticsÂ :
- **AprÃ¨s l'installation**Â : vÃ©rifiez que l'installation d'AgileFlow s'est terminÃ©e avec succÃ¨s
- **Avant les opÃ©rations majeures**Â : vÃ©rifiez l'Ã©tat du systÃ¨me avant des changements importants
- **PÃ©riodiquement**Â : exÃ©cutez-le mensuellement/trimestriellement pour maintenir l'Ã©tat du systÃ¨me.
- **AprÃ¨s les modifications de configuration**Â : vÃ©rifiez que les modifications ont Ã©tÃ© correctement prises en compte
- **Au dÃ©marrage**Â : si vous rencontrez des problÃ¨mes, commencez ici pour le dÃ©pannage

## Codes de sortie

- **0**Â : toutes les vÃ©rifications ont rÃ©ussi, le systÃ¨me est sain
- **1**Â :Â un ou plusieurs problÃ¨mes dÃ©tectÃ©s nÃ©cessitant une attention particuliÃ¨re

Cela permet Ã  la commande d'Ãªtre utilisÃ©e dans les pipelines CI/CD et les scripts automatisÃ©s.

## Actions recommandÃ©es

Si les problÃ¨mes sont foet suivez ces Ã©tapesÂ :

1. **JSON invalide**Â : utilisez `jq . <file>` pour identifier et corriger manuellement les erreurs de syntaxe
2. **Fichiers volumineux**Â : ExÃ©cutez l'archivageÂ : `bash scripts/archive-completed-stories.sh`
3. **Fichiers manquants**Â : RÃ©installezÂ : `npx agileflow setup`
4. **ProblÃ¨mes de format**Â : ExÃ©cutez la migrationÂ : `/agileflow:configure --migrate`
5. **RÃ©exÃ©cutez les diagnostics**Â : vÃ©rifiez que les problÃ¨mes sont rÃ©solus

## Commandes associÃ©es

- [`/configure`](/commands/configure) - Configurer les fonctionnalitÃ©s AgileFlow
- [`/validate-expertise`](/commands/validate-expertise) - Valider les dossiers d'expertise
- [`/compress`](/commands/compress) - Compresser status.json et rÃ©duire la taille du fichier