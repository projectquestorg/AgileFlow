---
title: "/diagnostiquer"
description: Diagnostic de l'Ã©tat du systÃ¨me
---

# /diagnostiquer

ExÃ©cutez des vÃ©rifications complÃ¨tes de lâ€™Ã©tat du systÃ¨me AgileFlow pour identifier les problÃ¨mes potentiels avant quâ€™ils ne provoquent des pannes.

## DÃ©marrage rapide

```bash
/agileflow:diagnose
```

Cela effectue une suite de diagnostics complÃ¨te sans aucun argument requis.

## ParamÃ¨tres

Cette commande ne prend aucun paramÃ¨treÂ : elle exÃ©cute automatiquement toutes les vÃ©rifications de diagnostic.

## Ce qu'il vÃ©rifie

Le systÃ¨me de diagnostic valide l'intÃ©gralitÃ© de votre installation AgileFlowÂ :

### 1. Validation des fichiers JSON
- Valide tous les fichiers JSON critiques (status.json, mÃ©tadonnÃ©es, paramÃ¨tres)
- VÃ©rifie le format et la structure du fichier
- Rapporte la taille des fichiers en Ko
- Avertit si status.json dÃ©passe 100 Ko (recommande l'archivage)
- Affiche le nombre d'histoires dans les fichiers actifs et archivÃ©s

### 2. IntÃ©gritÃ© de la structure des fichiers
- VÃ©rifie que les rÃ©pertoires requis existent (docs/, .agileflow/, .claude/)
- VÃ©rifie les fichiers critiques (metadata.json, status.json)
- Fait la distinction entre les fichiers critiques et facultatifs

### 3. SystÃ¨me d'archivage automatique
- VÃ©rifie si le script d'archive existe et est exÃ©cutable
- VÃ©rifie la configuration du hook dans .claude/settings.json
- Rapporte le seuil d'archivage Ã  partir des mÃ©tadonnÃ©es
- Identifie les composants manquants ou mal configurÃ©s

### 4. SystÃ¨me de crochets
- Valide la structure .claude/settings.json
- Compte les hooks SessionStart, UserPromptSubmit et Stop
- Signale des problÃ¨mes de configuration
- VÃ©rifie lâ€™exÃ©cutabilitÃ© du hook

### 5. Analyse de la taille du fichier
- Surveille la taille de status.json avec des seuils
- Affiche le nombre d'histoires actives et archivÃ©es
- Recommande l'archivage en cas de besoin
- Fournit des recommandations basÃ©es sur la taille

## Exemples

### Diagnostics de base

```bash
/agileflow:diagnose
```

ExÃ©cute un contrÃ´le de santÃ© complet du systÃ¨me et affiche les rÃ©sultats.

### Indicateurs de sortie

Le diagnostic utilise ces indicateurs d'Ã©tatÂ :
- **âœ…** (coche) : Bilan de santÃ© rÃ©ussi
- **âŒ** (croix)Â : Ã©chec du contrÃ´le de santÃ©
- **âš ï¸** (avertissement)Â : problÃ¨me non critique dÃ©tectÃ©
- **â„¹ï¸** (info)Â : statut informatif

## Sortie typique

```text
ğŸ” AgileFlow System Diagnostics
================================

ğŸ“‹ JSON File Validation
----------------------
  âœ… docs/00-meta/agileflow-metadata.json (42KB)
  âœ… docs/09-agents/status.json (28KB, 12 stories)
  â„¹ï¸  docs/09-agents/status-archive.json - not found (optional)
  âœ… .claude/settings.json (5KB)

ğŸ“¦ Auto-Archival System
----------------------
  âœ… Archive script exists and is executable
  âœ… Auto-archival hook configured
  âœ… Archival threshold: 7 days

ğŸª Hooks System
---------------
  âœ… .claude/settings.json is valid JSON
  â„¹ï¸  SessionStart hooks: 2
  â„¹ï¸  UserPromptSubmit hooks: 1
  â„¹ï¸  Stop hooks: 1

ğŸ“ File Size Analysis
---------------------
  status.json: 28KB (12 stories)
  âœ… status.json size is healthy

ğŸ“Š Diagnostic Summary
=====================
âœ… All checks passed! System is healthy.
```

## ProblÃ¨mes courants dÃ©tectÃ©s

| Issue | Indicator | Solution |
|-------|-----------|----------|
| Invalid JSON syntax | âŒ | Fix JSON using `jq . <file>` to identify errors |
| Large status.json (>100KB) | âš ï¸ | Run archival to reduce file size |
| Missing critical files | âŒ | Run `npx agileflow setup` to recreate |
| Archive script not executable | âš ï¸ | Run `chmod +x scripts/archive-completed-stories.sh` |
| Archival hook not configured | âŒ | Run `/agileflow:configure --enable=archival` |
| Invalid .claude/settings.json | âŒ | Run `/agileflow:configure --migrate` to fix format |

## When to Run

ExÃ©cutez des diagnosticsÂ :
- **After setup**: Verify AgileFlow installation completed successfully
- **Before major operations**: VÃ©rifiez l'Ã©tat du systÃ¨me avant des changements importants
- **Periodically**: ExÃ©cuter mensuellement/trimestriellement pour maintenir la santÃ© du systÃ¨me
- **After configuration changes**: VÃ©rifiez que les modifications ont Ã©tÃ© correctement prises en compte
- **On startup**:Â Si vous rencontrez des problÃ¨mes, commencez ici pour le dÃ©pannage

## Codes de sortie

- **0**:Â Tous les contrÃ´les ont rÃ©ussi, le systÃ¨me est sain
- **1**:Â Un ou plusieurs problÃ¨mes dÃ©tectÃ©s nÃ©cessitant une attention particuliÃ¨re

Cela permet Ã  la commande d'Ãªtre utilisÃ©e dans les pipelines CI/CD et les scripts automatisÃ©s.

## Actions recommandÃ©es

Si des problÃ¨mes sont dÃ©tectÃ©s, procÃ©dez comme suitÂ :

1. **Invalid JSON**: Utiliser `jq . <file>` pour identifier et corriger manuellement les erreurs de syntaxe
2. **Large files**: ExÃ©cuter l'archivageÂ : `bash scripts/archive-completed-stories.sh`
3. **Missing files**: RÃ©installerÂ : `npx agileflow setup`
4. **Format issues**: ExÃ©cuter la migrationÂ : `/agileflow:configure --migrate`
5. **Re-run diagnostics**: VÃ©rifiez que les problÃ¨mes sont rÃ©solus

## Commandes associÃ©es

- [`/configurer`](/commands/configure) - Configurer les fonctionnalitÃ©s AgileFlow
- [`/valider-expertise`](/commands/validate-expertise) - Valider les dossiers d'expertise
- [`/compresser`](/commands/compress) - Compresser status.json et rÃ©duire la taille du fichier
