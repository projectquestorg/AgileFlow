---
title: /revisar
description: Revisi√≥n de c√≥digo impulsada por IA con sugerencias de calidad
---

# /revisar

Realice una revisi√≥n integral del c√≥digo basada en IA sobre los cambios en las solicitudes de extracci√≥n. Review analiza el c√≥digo en cuanto a calidad, seguridad, rendimiento, mejores pr√°cticas y proporciona comentarios pr√°cticos con ejemplos de c√≥digo espec√≠ficos.

## Inicio r√°pido

```bash
# Review current branch against main
/agileflow:review

# Review specific branch
/agileflow:review BRANCH=feature/auth

# Review with focus on security
/agileflow:review FOCUS=security
```

El comando:
1. Obtener cambios de c√≥digo (git diff)
2. Analice en 6 categor√≠as (calidad, seguridad, rendimiento, mejores pr√°cticas, pruebas, documentaci√≥n)
3. Genere un informe detallado con problemas priorizados por gravedad
4. Calcular el puntaje de calidad del c√≥digo
5. Sugerir correcciones autom√°ticas y trabajos de seguimiento.

## Caracter√≠sticas clave

### An√°lisis integral

La revisi√≥n examina los cambios de su c√≥digo en 6 categor√≠as importantes:

| Category | Checks |
|----------|--------|
| **Code Quality** | Complexity, duplication, naming, function/file length |
| **Security** | SQL injection, XSS, hardcoded secrets, unsafe deserialization |
| **Performance** | N+1 queries, inefficient algorithms, memory leaks |
| **Best Practices** | Error handling, logging, type safety, async/await |
| **Testing** | Missing tests, test quality, coverage gaps |
| **Documentation** | Missing JSDoc, outdated comments, README updates |

### Priorizaci√≥n basada en la gravedad

Los problemas se clasifican por impacto:

```text
üî¥ CRITICAL - Must fix before merge
üü† HIGH    - Fix before merge (blocks release)
üü° MEDIUM  - Address soon (technical debt)
‚ö™ LOW     - Nice to have (style/consistency)
```

### Puntuaci√≥n de calidad del c√≥digo

Su PR obtiene una puntuaci√≥n (0-100) desglosada por categor√≠a:

```text
Code Quality Score: 72/100

Breakdown:
- Security: 40/100 (critical issues found)
- Performance: 75/100 (one N+1 query)
- Maintainability: 80/100 (some complexity)
- Testing: 65/100 (coverage gaps)
- Style: 90/100 (mostly consistent)
```

### Comentarios constructivos

Cada n√∫mero incluye:
- D√≥nde est√° (archivo, n√∫mero de l√≠nea)
- Por qu√© es importante (riesgo/impacto)
- C√≥mo solucionarlo (ejemplos de c√≥digo espec√≠ficos)
- Ejemplo de ‚ùå c√≥digo MAL
- Ejemplo de ‚úÖ BUEN c√≥digo

## Uso

### B√°sico - revisar la sucursal actual

```bash
/agileflow:review
```

Revisa los cambios en la rama actual con respecto a principal/maestra.

### Revisar sucursal espec√≠fica

```bash
/agileflow:review BRANCH=feature/user-auth
```

Revisa la rama nombrada con respecto a la principal.

### Revisi√≥n contra diferentes bases

```bash
/agileflow:review BRANCH=feature/auth BASE=develop
```

Se compara con una rama base diferente.

### Revisi√≥n con √°rea de enfoque

```bash
# Security-only review
/agileflow:review FOCUS=security

# Performance-only review
/agileflow:review FOCUS=performance

# Testing coverage review
/agileflow:review FOCUS=tests
```

### Filtrar por gravedad

```bash
# Show only critical/high issues
/agileflow:review SEVERITY=high

# Show all issues
/agileflow:review SEVERITY=all
```

## Par√°metros

| Parameter | Required | Default | Options |
|-----------|----------|---------|---------|
| `BRANCH` | No | Current | Branch name to review |
| `BASE` | No | main/master | Base branch for comparison |
| `FOCUS` | No | all | all, security, performance, style, tests |
| `SEVERITY` | No | all | critical, high, medium, low, all |

## Ejemplos

### Revisi√≥n t√≠pica de relaciones p√∫blicas

```bash
/agileflow:review

# Output:
# AI Code Review Report
# Branch: feature/user-auth
# Files Changed: 5
# Critical: 1 | High: 3 | Medium: 5 | Low: 2
# Code Quality Score: 72/100
#
# üî¥ CRITICAL ISSUES
# - Hardcoded API key in stripe.ts:15
#
# üü† HIGH ISSUES
# - N+1 query in posts API
# - Missing error handling in login
# ...
```

### Revisi√≥n centrada en la seguridad

```bash
/agileflow:review FOCUS=security

# Analyzes only for:
# - Hardcoded secrets
# - SQL injection risks
# - XSS vulnerabilities
# - Authentication issues
# - CORS misconfiguration
```

### Revisi√≥n de desempe√±o

```bash
/agileflow:review FOCUS=performance

# Checks for:
# - N+1 database queries
# - Inefficient algorithms
# - Missing indexes
# - Memory leaks
# - Bundle size issues
```

## Revisar la estructura del informe

### Encabezamiento

```text
# AI Code Review Report

**Branch**: feature/user-auth
**Base**: main
**Files Changed**: 8
**Lines Added**: 245
**Lines Removed**: 32
**Generated**: 2025-10-16T10:30:00Z
```

### Resumen

```text
## Summary

**Critical**: 2 | **High**: 5 | **Medium**: 12 | **Low**: 8
**Must Fix Before Merge**: 7 issues
```

### Problemas por gravedad

Para cada tema:

```text
### 1. Hardcoded API Key (SECURITY)
**File**: src/api/payments/stripe.ts:15
**Severity**: CRITICAL

// ‚ùå BAD
const stripeKey = "sk_live_abc123...";

// ‚úÖ GOOD
const stripeKey = process.env.STRIPE_SECRET_KEY;
if (!stripeKey) throw new Error("STRIPE_SECRET_KEY not set");

**Risk**: API key exposed in version control.
**Fix**: Move to environment variable. Rotate immediately.
**Priority**: Block merge
```

### Observaciones positivas

```text
## Positive Observations ‚úÖ

- ‚úÖ Good use of TypeScript strict mode
- ‚úÖ Consistent error handling pattern
- ‚úÖ Well-structured component separation
- ‚úÖ Clear commit messages
```

### Desglose de la calidad del c√≥digo

```text
## Code Quality Score: 72/100

**Breakdown**:
- Security: 40/100 (2 critical issues)
- Performance: 75/100 (1 N+1 query)
- Maintainability: 80/100 (some complexity)
- Testing: 65/100 (coverage gaps)
- Style: 90/100 (mostly consistent)
```

## Personalizaci√≥n

### Reglas espec√≠ficas del proyecto

Cree reglas de revisi√≥n personalizadas en:
- `.agileflow/review-rules.md`
- `docs/02-practices/code-standards.md`

Ejemplo:

```markdown
# Code Review Rules

## Critical
- No console.log in production code
- All API endpoints must have rate limiting
- All database queries must use ORM

## High
- Functions >30 lines should be refactored
- Test coverage must be >85%
```

## Acciones despu√©s de la revisi√≥n

### Problemas de soluci√≥n autom√°tica

```text
Review asks: "Fix auto-fixable issues? (YES/NO)"

If YES:
  - Runs npm run lint -- --fix
  - Fixes 8 style issues automatically
  - Shows which issues were fixed
```

### Crear historias de seguimiento

```text
Review asks: "Create stories for follow-up work?"

If YES:
  - Creates story for each medium/low issue
  - Adds to your backlog
  - Links to code review report
```

### Combinaci√≥n de bloques para problemas cr√≠ticos

```text
Review asks: "Block merge for critical/high issues?"

If YES:
  - Marks merge as blocked
  - Provides failure reason
  - Suggests resolution steps
```

### Guardar informe

Informe guardado autom√°ticamente en:
```text
docs/08-project/code-reviews/<YYYYMMDD>-<BRANCH>.md
```

Ejemplo:
```text
docs/08-project/code-reviews/20251016-feature-user-auth.md
```

## Controles de seguridad

La revisi√≥n comprueba autom√°ticamente:

### Secretos y credenciales
- Claves API codificadas
- Contrase√±as de bases de datos
- tokens de OAuth
- Secretos de JWT
- Credenciales de AWS

### Vulnerabilidades comunes
- Inyecci√≥n SQL (consultas no parametrizadas)
- Ataques XSS (salida sin escape)
- Deserializaci√≥n insegura
- Vulnerabilidades CSRF
- Falta la validaci√≥n de CORS

### Patrones inseguros
- evaluaci√≥n() o funci√≥n()
- Concatenaci√≥n de cadenas insegura
- Falta validaci√≥n de entrada
- Cifrado d√©bil
- Dependencias inseguras

## Comprobaciones de rendimiento

La revisi√≥n busca:

### Base de datos
- N+1 problemas de consulta
- √çndices faltantes
- Uniones ineficientes
- Consultas innecesarias

### Algoritmos
- O(n¬≤) cuando O(n) es posible
- Bucles anidados que podr√≠an ser planos
- C√°lculos repetidos
- recursividad no optimizada

### Memoria
- Fugas de memoria
- Objetos grandes no liberados
- Referencias circulares
- Estructuras de datos que acaparan la memoria

## Cobertura de pruebas

Revisar cheques:

### Nuevo c√≥digo
- ¬øExiste una prueba para nuevas funciones?
- ¬øEst√°n cubiertos los casos extremos?
- ¬øLa calidad de la prueba es buena?

### Brechas de cobertura
- L√≠neas agregadas sin pruebas.
- Funciones sin cobertura de prueba
- Rutas de error no probadas

### Calidad de la prueba
- ¬øTienen significado las afirmaciones?
- ¬øLas pruebas verifican el comportamiento?
- ¬øSe pueden mantener las pruebas?

## Resultados y recomendaciones

### Acciones inmediatas (fusi√≥n de bloques)

```text
1. Remove hardcoded API key (critical)
2. Fix SQL injection (critical)
3. Add error handling to login (high)
```

### Antes de fusionar

```text
4. Add tests for auth endpoints (high)
5. Fix N+1 query in posts API (high)
6. Reduce complexity in validator.ts (medium)
```

### Seguimiento (Crear Historias)

```text
7. Standardize naming conventions (medium)
8. Add ESLint rule for secrets (medium)
9. Set up automated security scanning (low)
```

## Integraci√≥n con CI

Sugerir agregar a `.github/workflows/pr.yml`:

```yaml
- name: AI Code Review
  run: npx claude-code /agileflow:review BRANCH=${{ github.head_ref }}

- name: Check for critical issues
  run: |
    if grep -q "CRITICAL" code-review-report.md; then
      echo "::error::Critical issues found."
      exit 1
    fi
```

## Consejos

### Antes de enviar PR

```bash
/agileflow:review
# Fix any CRITICAL or HIGH issues
# Address MEDIUM issues if possible
# Then submit PR with confidence
```

### Mejora iterativa

```bash
# After feedback, run review again
/agileflow:review

# See if score improved
# Ensure critical issues fixed
# Check test coverage
```

### Enfoque centrado en la seguridad

```bash
# Always check security first
/agileflow:review FOCUS=security

# Fix any CRITICAL security issues
# Then review other categories
```

## Principios

- **Be constructive** - Proporcionar comentarios pr√°cticos, no s√≥lo cr√≠ticas.
- **Show examples** - Incluye c√≥digo ‚ùå MALO y ‚úÖ BUEN
- **Prioritize** - Las cuestiones cr√≠ticas primero, el estilo al final
- **Celebrate** - Incluir observaciones positivas.
- **Suggest fixes** - No se limite a identificar los problemas
- **No force commits** - Pregunte siempre antes de realizar la reparaci√≥n autom√°tica

## Comandos relacionados

- [`/pr`](/commands/pr) - Generar descripci√≥n de relaciones p√∫blicas (revisar antes de enviar)
- [`/impacto`](/commands/impact) - Analizar el impacto del cambio.
- [`/cuidar`](/commands/babysit) - Gu√≠a de implementaci√≥n (ejecuta la revisi√≥n antes del PR)
- [`/verificar`](/commands/verify) - Verificar el paso de las pruebas.
- [`/l√≠nea de base`](/commands/baseline) - Crear punto de control verificado
