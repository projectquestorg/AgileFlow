---
title: /ضغط
description: قم بضغط Status.json عن طريق إزالة الحقول المطولة والاحتفاظ بتتبع البيانات الوصفية فقط
---
# / ضغط

قم بتقليل حجم ملف Status.json عن طريق إزالة حقول القصة المطولة مع الحفاظ على جميع بيانات تعريف التتبع الهامة والحفاظ على تفاصيل القصة الكاملة في ملفات تخفيض السعر.

## بداية سريعة

__لا تترجم_0__

## الغرض

يحل هذا الأمر مشكلة شائعة: عندما ينمو `status.json` بشكل كبير (خاصة في المشروعات الكبيرة التي تحتوي على أكثر من 100 قصة)، يمكن أن يتجاوز حدود الرمز المميز ويبطئ معالجة الوكيل. أمر الضغط:
- إزالة الحقول المطولة (الأوصاف، AC، سياق البنية، وما إلى ذلك)
- يحتفظ فقط ببيانات تعريف التتبع الأساسية (معرف القصة، والحالة، والمالك، والطوابع الزمنية)
- يقلل حجم الملف بنسبة 80-90% عادةً
- يحافظ على محتوى القصة الكاملة في ملفات تخفيض السعر
- يحافظ على تاريخ المشروع الكامل
- يضمن أن الوكلاء يمكنهم قراءة Status.json بكفاءة

## المعلمات

لا يحتوي هذا الأمر على أي معلمات - فهو يعمل مباشرة على `docs/09-agents/status.json`.

## الاستخدام

ببساطة قم بتشغيل:

__لا تترجم_1__

الأمر سوف:
1. التحقق من وجود Status.json وصلاحيته لـ JSON
2. عرض قبل الإحصائيات (الحجم، الخطوط، قصة القصةنت)
3. إنشاء نسخة احتياطية تلقائية
4. قم بإزالة الحقول المطولة
5. كتابة نسخة مضغوطة
6. عرض بعد الإحصائيات والمدخرات

## ما تتم إزالته

تتم إزالة هذه الحقول المطولة من Status.json:

__لا تترجم_2__

ويتم حفظها بأمان في ملفات تخفيض السعر `docs/06-stories/` بدلاً من ذلك.

## ما يتم الاحتفاظ به

تبقى بيانات تعريف التتبع الأساسية فقط في Status.json:

__لا تترجم_3__

## إخراج المثال

__لا تترجم_4__

## متى يستخدم

### استخدم الضغط عندما:

1. **status.json يتجاوز 25000 رمز مميز**
   - فشل الوكلاء بسبب "تجاوز محتوى الملف الحد الأقصى المسموح به من الرموز المميزة"

2. ** الملف بطيء في المعالجة **
   - كبير جدًا بالنسبة لنوافذ السياق
   - يسبب مشاكل المهلة

3. **بعد الانتهاء الملحمي الكبير**
   - العديد من القصص المكتملة مع السجلات المطولة
   - نما المشروع بشكل ملحوظ

4. ** صيانة ربع سنوية **
   - التنظيف المنتظم للحفاظ على تتبع الهزيل

### البديل: دمج مع الأرشيف

للحصول على نتائج أفضل، اجمع بين الضغط والأرشفة:

__لا تترجم_5__

هذه العملية المكونة من خطوتينيحقق ss أقصى قدر من التخفيض مع الحفاظ على التاريخ.

## السلامة والنسخ الاحتياطي

### النسخ الاحتياطي التلقائي

قبل الضغط، يقوم الأمر بإنشاء نسخة احتياطية:
__لا تترجم_6__

### عدم فقدان البيانات

- يظل محتوى القصة الكاملة في ملفات تخفيض السعر `docs/06-stories/`
- لا يتم تعديل ملفات تخفيض السعر للقصة
- يتم ضغط فهرس Status.json فقط
- يمكن دائمًا الاستعادة من النسخة الاحتياطية

### استعادة إذا لزم الأمر

__لا تترجم_7__

تحتوي النسخة الاحتياطية على الملف الأصلي الكامل.

## لماذا هذه الهندسة المعمارية؟

### فصل الاهتمامات

**status.json** = مؤشر تتبع خفيف الوزن
- "ما هي القصص الموجودة؟"
- "من يملك كل قصة؟"
- "ما هو الوضع الحالي؟"
- "متى تم تحديثه؟"

**docs/06-stories/** = محتوى القصة الكاملة
- أوصاف كاملة
- معايير القبول
- القرارات المعمارية
- ملاحظات التنفيذ
- استراتيجيات الاختبار

**docs/09-agents/archive/** = البيانات التاريخية
- قصص مكتملة أقدم من العتبة
- التنظيم الشهري
- القدرة على الاسترجاع الكامل

### الفوائد

1. **الفهرسة السريعة** - الوكيلقراءة الحالة.json بسرعة
2. **المحتوى الكامل** - التفاصيل الكاملة في تخفيض القصة
3. **قابل للبحث** - يمكن دمج ملفات القصة للمحتوى
4. **قابل للإصدار** - يتم تعقب جميع الملفات عن طريق البوابة
5. **قابلة للأرشفة** - القصص القديمة لا تزيد من مؤشر التتبع

## تقدير الرمز المميز

يقوم الأمر بتقدير استخدام الرمز المميز:

__لا تترجم_8__

الهدف: احتفظ بـstatus.json أقل من 25000 رمز مميز (100 كيلو بايت مضغوطة).

## تكامل سير العمل

### مع حافلة الوكيل

لا يؤثر ضغط Status.json على:
- ناقل رسائل الوكيل (`docs/09-agents/bus/log.jsonl`)
- التواصل والتنسيق بين الوكلاء
- تتبع حالة القصة

### مع CI/CD

يمكن إضافة الضغط إلى أتمتة CI:

__لا تترجم_9__

## السيناريوهات الشائعة

### السيناريو 1: نمو المشروع بشكل كبير

**المشكلة**: يبلغ حجمstatus.json 250 كيلو بايت ويحتوي على 150 قصة
**الحل**:
__لا تترجم_10__
**النتيجة**: يتم تقليل الحجم إلى 30 كيلو بايت، وهو ما يقل بسهولة عن حدود الرمز المميز

### السيناريو 2: العديد من القصص المكتملة

**المشكلة**: 120 قصة مكتملة و30 قصة نشطة؛ Status.json منتفخة
**الحل**:
__لا تترجم_11__
**النتيجة**: نقل القصص القديمة إلى الأرشيف، والضغط المتبقي

### السيناريو 3: الصيانة الدورية

**المشكلة**: هل تريد الاحتفاظ بحالة json الهزيلة تلقائيًا
**الحل**: إضافة إلى جدول CI (الضغط الشهري)
**النتيجة**: دائمًا ضمن حدود الرمز المميز، معالجة سريعة للوكيل

## استكشاف الأخطاء وإصلاحها

### "status.json لا يزال كبيرًا جدًا بعد الضغط"

حاول أرشفة أكثر عدوانية:
__لا تترجم_12__

### "فقدان المعلومات الهامة بعد الضغط"

استعادة من النسخة الاحتياطية:
__لا تترجم_13__

تحقق مما إذا كانت ملفات تخفيض القصة تحتوي على التفاصيل في `docs/06-stories/`.

### "لا يمكن العثور على تفاصيل القصة"

محتوى القصة موجود في ملفات تخفيض السعر:
__لا تترجم_14__

## أفضل الممارسات

1. **الضغط المنتظم** - يتم تشغيله شهريًا أو ربع سنويًا
2. **الأرشفة بقوة** - انقل القصص القديمة المكتملة أولاً
3. **النسخ الاحتياطي قبل** - يؤدي الضغط إلى إنشاء نسخة احتياطية تلقائيًا
4. **التحقق بعد** - تحقق من تقدير الرمز المميز في المخرجات
5. **إجراء التغييرات** - أضف الحالة المضغوطة إلى git
6. **سياسة الوثيقة** - سجل متى/لماذا شركاتيعمل ريسيون
7. **اختبار الاستعادة** - تحقق من عمل النسخ الاحتياطي إذا لزم الأمر

## الأوامر ذات الصلة

- [`/agileflow:status`](/commands/status) - عرض حالات القصة الحالية
- [`/agileflow:validate`](/commands/validate) - التحقق من صحة نظام AgileFlow
- نص الأرشيف: `bash .agileflow/scripts/archive-completed-stories.sh` - انقل القصص المكتملة إلى الأرشيف

## التفاصيل الفنية

### الملفات المعنية

| ملف | الغرض |
|------|---------|
| __غير مترجم_25__ | مؤشر تتبع خفيف الوزن (مضغوط) |
| __غير مترجم_26__ | النسخ الاحتياطي التلقائي قبل الضغط |
| __غير مترجم_27__ | ملفات تخفيض القصة الكاملة (بدون تغيير) |
| __غير مترجم_28__ | قصص تاريخية مكتملة |

### التنفيذ

يستخدم البرنامج النصي للضغط `jq` لمعالجة JSON:

__لا تترجم_15__

### حساب الرمز المميز

التقدير التقريبي المستخدم في الإخراج:
- رمز واحد ≈ 4 أحرف/بايت (تقريبي)
- ملف بحجم 100 كيلو بايت ≈ 25000 رمزًا
- الهدف: <100 كيلو بايت ليظل ضمن الحدود المسموح بها

## الأسئلة الشائعة

__لا تترجم_31__
  __لا تترجم_32__
    <AccordionTrigger> هل هناك ضغطهل تريد حذف ملفات القصة؟</AccordionTrigger>
    __لا تترجم_34__
      لا، يتم تعديل Status.json فقط. لم يتم تغيير تخفيض القصة في docs/06-stories/.
    __لا تترجم_51__
  __لا تترجم_52__
  __لا تترجم_35__
    <AccordionTrigger>هل يمكنني التراجع عن الضغط؟</AccordionTrigger>
    __لا تترجم_37__
      نعم. يتم إنشاء نسخة احتياطية تلقائيا. فقط قم باستعادة: `cp docs/09-agents/status.json.backup docs/09-agents/status.json`
    __لا تترجم_54__
  __لا تترجم_55__
  __لا تترجم_38__
    <AccordionTrigger>متى يجب الضغط؟</AccordionTrigger>
    __لا تترجم_40__
      عندما يتجاوز حجمstatus.json 25 كيلو بايت، أو شهريًا كصيانة. ادمجها مع الأرشيف للحصول على أفضل النتائج.
    __لا تترجم_57__
  __لا تترجم_58__
  __لا تترجم_41__
    <AccordionTrigger>هل يؤثر هذا على أداء الوكيل؟</AccordionTrigger>
    __لا تترجم_43__
      نعم يحسنها بشكل كبير. أصغر Status.json = قراءة أسرع وسياق أكثر توفرًا للوكلاء.
    __لا تترجم_60__
  __لا تترجم_61__
  __لا تترجم_44__
    __لا تترجم_45__ساعةحول تاريخ git؟</AccordionTrigger>
    __لا تترجم_46__
      جميع التغييرات ملتزمة. الإصدارات السابقة موجودة في سجل git إذا لزم الأمر.
    __لا تترجم_63__
  __لا تترجم_64__
  __لا تترجم_47__
    <AccordionTrigger>هل يمكنني تخصيص الحقول التي سيتم الاحتفاظ بها؟</AccordionTrigger>
    __لا تترجم_49__
      نعم، قم بتحرير البرنامج النصي للضغط للاحتفاظ بالحقول الإضافية إذا لزم الأمر لسير عملك.
    __لا تترجم_66__
  __لا تترجم_67__
__لا تترجم_68__